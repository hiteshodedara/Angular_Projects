/**
 * @license
 * Copyright Akveo. All Rights Reserved.
 * Licensed under the MIT License. See License.txt in the project root for license information.
 */
import { map, delay, filter, takeUntil } from 'rxjs/operators';
import { Component, Input, Output, EventEmitter, ContentChildren, HostBinding, ContentChild, } from '@angular/core';
import { Subject } from 'rxjs';
import { convertToBoolProperty } from '../helpers';
import { NbTabContentDirective } from './tab-content.directive';
import { NbTabTitleDirective } from './tab-title.directive';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common";
import * as i2 from "@angular/router";
import * as i3 from "../badge/badge.component";
import * as i4 from "../icon/icon.component";
/**
 * Specific tab container.
 *
 * ```ts
 * <nb-tab tabTitle="Users"
 *   badgeText="99+"
 *   badgeStatus="danger">
 *   <p>List of <strong>users</strong>.</p>
 * </nb-tab>
 * ```
 */
export class NbTabComponent {
    constructor() {
        this.activeValue = false;
        this.responsiveValue = false;
        this.disabledValue = false;
        /**
         * Badge status (adds specific styles):
         * 'primary', 'info', 'success', 'warning', 'danger'
         * @param {string} val
         */
        this.badgeStatus = 'basic';
        /**
         * @deprecated
         * @breaking-change Remove 12.0.0
         * @docs-private
         */
        this.init = false;
    }
    /**
     * Use badge dot mode
     * @type {boolean}
     */
    get badgeDot() {
        return this._badgeDot;
    }
    set badgeDot(val) {
        this._badgeDot = convertToBoolProperty(val);
    }
    /**
     * Item is disabled and cannot be opened.
     * @type {boolean}
     */
    get disabled() {
        return this.disabledValue;
    }
    set disabled(val) {
        this.disabledValue = convertToBoolProperty(val);
    }
    /**
     * Show only icons when width is smaller than `tabs-icon-only-max-width`
     * @type {boolean}
     */
    set responsive(val) {
        this.responsiveValue = convertToBoolProperty(val);
    }
    get responsive() {
        return this.responsiveValue;
    }
    /**
     * Specifies active tab
     * @returns {boolean}
     */
    get active() {
        return this.activeValue;
    }
    set active(val) {
        this.activeValue = convertToBoolProperty(val);
        if (this.activeValue) {
            this.init = true;
        }
    }
    /**
     * Lazy load content before tab selection
     * @docs-private
     * @deprecated This setting never worked. Wrap content into a `nbTabContent` to make it lazy.
     * @breaking-change Remove 12.0.0
     */
    set lazyLoad(val) {
        this.init = convertToBoolProperty(val);
    }
}
NbTabComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: NbTabComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
NbTabComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.4", type: NbTabComponent, selector: "nb-tab", inputs: { tabTitle: "tabTitle", tabId: "tabId", badgeDot: "badgeDot", tabIcon: "tabIcon", disabled: "disabled", responsive: "responsive", route: "route", active: "active", lazyLoad: "lazyLoad", badgeText: "badgeText", badgeStatus: "badgeStatus", badgePosition: "badgePosition" }, host: { properties: { "class.disabled": "this.disabled", "class.content-active": "this.activeValue" } }, queries: [{ propertyName: "tabContentDirective", first: true, predicate: NbTabContentDirective, descendants: true }, { propertyName: "tabTitleDirective", first: true, predicate: NbTabTitleDirective, descendants: true }], ngImport: i0, template: `
    <ng-container
      *ngIf="tabContentDirective; else projectedContent"
      [ngTemplateOutlet]="tabContentDirective.templateRef"
    ></ng-container>

    <ng-template #projectedContent>
      <ng-content></ng-content>
    </ng-template>
  `, isInline: true, dependencies: [{ kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i1.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: NbTabComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'nb-tab',
                    template: `
    <ng-container
      *ngIf="tabContentDirective; else projectedContent"
      [ngTemplateOutlet]="tabContentDirective.templateRef"
    ></ng-container>

    <ng-template #projectedContent>
      <ng-content></ng-content>
    </ng-template>
  `,
                }]
        }], propDecorators: { tabContentDirective: [{
                type: ContentChild,
                args: [NbTabContentDirective]
            }], tabTitleDirective: [{
                type: ContentChild,
                args: [NbTabTitleDirective]
            }], tabTitle: [{
                type: Input
            }], tabId: [{
                type: Input
            }], badgeDot: [{
                type: Input
            }], tabIcon: [{
                type: Input
            }], disabled: [{
                type: Input,
                args: ['disabled']
            }, {
                type: HostBinding,
                args: ['class.disabled']
            }], responsive: [{
                type: Input
            }], route: [{
                type: Input
            }], activeValue: [{
                type: HostBinding,
                args: ['class.content-active']
            }], active: [{
                type: Input
            }], lazyLoad: [{
                type: Input
            }], badgeText: [{
                type: Input
            }], badgeStatus: [{
                type: Input
            }], badgePosition: [{
                type: Input
            }] } });
// TODO: Combine tabset with route-tabset, so that we can:
// - have similar interface
// - easy to migrate from one to another
// - can mix them both (route/content tab)
/**
 *
 * Dynamic tabset component.
 * @stacked-example(Showcase, tabset/tabset-showcase.component)
 *
 * Basic tabset example
 *
 * ```html
 * <nb-tabset>
 *  <nb-tab tabTitle="Simple Tab #1">
 *    Tab content 1
 *  </nb-tab>
 *  <nb-tab tabTitle="Simple Tab #2">
 *    Tab content 2
 *  </nb-tab>
 * </nb-tabset>
 * ```
 *
 * ### Installation
 *
 * Import `NbTabsetModule` to your feature module.
 * ```ts
 * @NgModule({
 *   imports: [
 *     // ...
 *     NbTabsetModule,
 *   ],
 * })
 * export class PageModule { }
 * ```
 * ### Usage
 *
 * It is also possible to set a badge to a particular tab:
 * @stacked-example(Tab With Badge, tabset/tabset-badge.component)
 *
 * and we can set it to full a width of a parent component
 * @stacked-example(Full Width, tabset/tabset-width.component)
 *
 * `tabIcon` should be used to add an icon to the tab. Icon can also be combined with title.
 * `responsive` tab property if set allows you to hide the title on smaller screens
 * (`$tabset-tab-text-hide-breakpoint` variable) for better responsive behaviour.
 * You can open the following example and make
 * your screen smaller - titles will be hidden in the last tabset in the list:
 * @stacked-example(Icon, tabset/tabset-icon.component)
 *
 * It is also possible to disable a tab using `disabled` property:
 * @stacked-example(Disabled Tab, tabset/tabset-disabled.component)
 *
 * By default, the tab contents instantiated straightaway. To make tab contents load lazy,
 * declare the body of a tab in a template with `nbTabContent` directive.
 * ```html
 * <nb-tabset>
 *   <nb-tab>
 *     <some-component *nbTabContent>Lazy content</some-component>
 *   </nb-tab>
 *   <nb-tab>
 *     <ng-template nbTabContent>
 *       Lazy content with template syntax
 *     </ng-template>
 *   </nb-tab>
 * </nb-tabset>
 * ```
 *
 * You can provide a template as a tab title via `<ng-template nbTabTitle>`:
 * @stacked-example(Tab title template, tabset/tabset-template-title.component)
 *
 * @styles
 *
 * tabset-background-color:
 * tabset-border-radius:
 * tabset-shadow:
 * tabset-tab-background-color:
 * tabset-tab-padding:
 * tabset-tab-text-color:
 * tabset-tab-text-font-family:
 * tabset-tab-text-font-size:
 * tabset-tab-text-font-weight:
 * tabset-tab-text-line-height:
 * tabset-tab-text-transform:
 * tabset-tab-underline-width:
 * tabset-tab-underline-color:
 * tabset-tab-active-background-color:
 * tabset-tab-active-text-color:
 * tabset-tab-active-underline-color:
 * tabset-tab-focus-background-color:
 * tabset-tab-focus-text-color:
 * tabset-tab-focus-underline-color:
 * tabset-tab-hover-background-color:
 * tabset-tab-hover-text-color:
 * tabset-tab-hover-underline-color:
 * tabset-tab-disabled-background-color:
 * tabset-tab-disabled-text-color:
 * tabset-tab-disabled-underline-color:
 * tabset-divider-color:
 * tabset-divider-style:
 * tabset-divider-width:
 * tabset-content-background-color:
 * tabset-content-padding:
 * tabset-content-text-color:
 * tabset-content-text-font-family:
 * tabset-content-text-font-size:
 * tabset-content-text-font-weight:
 * tabset-content-text-line-height:
 * tabset-scrollbar-color:
 * tabset-scrollbar-background-color:
 * tabset-scrollbar-width:
 */
export class NbTabsetComponent {
    /**
     * Take full width of a parent
     * @param {boolean} val
     */
    set fullWidth(val) {
        this.fullWidthValue = convertToBoolProperty(val);
    }
    constructor(route, changeDetectorRef) {
        this.route = route;
        this.changeDetectorRef = changeDetectorRef;
        this.fullWidthValue = false;
        /**
         * Emits when tab is selected
         * @type EventEmitter<any>
         */
        this.changeTab = new EventEmitter();
        this.destroy$ = new Subject();
    }
    // TODO: refactoring this component, avoid change detection loop
    ngAfterContentInit() {
        this.route.params
            .pipe(map((params) => this.tabs.find((tab) => (this.routeParam ? tab.route === params[this.routeParam] : tab.active))), delay(0), map((tab) => tab || this.tabs.first), filter((tab) => !!tab), takeUntil(this.destroy$))
            .subscribe((tabToSelect) => {
            this.selectTab(tabToSelect);
            this.changeDetectorRef.markForCheck();
        });
    }
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
    }
    // TODO: navigate to routeParam
    selectTab(selectedTab) {
        if (!selectedTab.disabled) {
            this.tabs.forEach((tab) => (tab.active = tab === selectedTab));
            this.changeTab.emit(selectedTab);
        }
    }
}
NbTabsetComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: NbTabsetComponent, deps: [{ token: i2.ActivatedRoute }, { token: i0.ChangeDetectorRef }], target: i0.ɵɵFactoryTarget.Component });
NbTabsetComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.4", type: NbTabsetComponent, selector: "nb-tabset", inputs: { fullWidth: "fullWidth", routeParam: "routeParam" }, outputs: { changeTab: "changeTab" }, host: { properties: { "class.full-width": "this.fullWidthValue" } }, queries: [{ propertyName: "tabs", predicate: NbTabComponent }], ngImport: i0, template: `
    <ul class="tabset">
      <li
        *ngFor="let tab of tabs"
        (click)="selectTab(tab)"
        (keyup.space)="selectTab(tab)"
        (keyup.enter)="selectTab(tab)"
        [class.responsive]="tab.responsive"
        [class.active]="tab.active"
        [class.disabled]="tab.disabled"
        [attr.tabindex]="tab.disabled ? -1 : 0"
        [attr.data-tab-id]="tab.tabId"
        class="tab"
      >
        <a href (click)="$event.preventDefault()" tabindex="-1" class="tab-link">
          <nb-icon *ngIf="tab.tabIcon" [config]="tab.tabIcon"></nb-icon>
          <ng-container
            *ngIf="tab.tabTitleDirective; else textTitleTemplate"
            [ngTemplateOutlet]="tab.tabTitleDirective.templateRef"
          ></ng-container>
          <ng-template #textTitleTemplate>
            <span class="tab-text">{{ tab.tabTitle }}</span>
          </ng-template>
        </a>
        <nb-badge
          *ngIf="tab.badgeText || tab.badgeDot"
          [text]="tab.badgeText"
          [dotMode]="tab.badgeDot"
          [status]="tab.badgeStatus"
          [position]="tab.badgePosition"
        >
        </nb-badge>
      </li>
    </ul>
    <ng-content select="nb-tab"></ng-content>
  `, isInline: true, styles: ["/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */:host{display:block}:host.full-width .tabset{justify-content:space-around}:host ::ng-deep nb-tab{flex:1;-ms-flex:1 1 auto;overflow:auto;display:none}:host ::ng-deep nb-tab.content-active{display:block}:host .tabset{display:flex;flex-direction:row;list-style-type:none;margin:0;padding:0}:host .tabset .tab{margin-bottom:-1px;text-align:center;position:relative}:host .tabset .tab.active a:before{display:block}:host .tabset .tab a{display:flex;position:relative;text-decoration:none}:host .tabset .tab a:before{position:absolute;content:\"\";width:100%;border-radius:3px;bottom:-2px;left:0}:host .tabset .tab a nb-icon{vertical-align:middle}[dir=ltr] :host .tabset .tab a nb-icon+span{margin-left:.5rem}[dir=rtl] :host .tabset .tab a nb-icon+span{margin-right:.5rem}\n"], dependencies: [{ kind: "directive", type: i1.NgForOf, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "directive", type: i1.NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "directive", type: i1.NgTemplateOutlet, selector: "[ngTemplateOutlet]", inputs: ["ngTemplateOutletContext", "ngTemplateOutlet", "ngTemplateOutletInjector"] }, { kind: "component", type: i3.NbBadgeComponent, selector: "nb-badge", inputs: ["text", "position", "dotMode", "status"] }, { kind: "component", type: i4.NbIconComponent, selector: "nb-icon", inputs: ["icon", "pack", "options", "status", "config"] }] });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: NbTabsetComponent, decorators: [{
            type: Component,
            args: [{ selector: 'nb-tabset', template: `
    <ul class="tabset">
      <li
        *ngFor="let tab of tabs"
        (click)="selectTab(tab)"
        (keyup.space)="selectTab(tab)"
        (keyup.enter)="selectTab(tab)"
        [class.responsive]="tab.responsive"
        [class.active]="tab.active"
        [class.disabled]="tab.disabled"
        [attr.tabindex]="tab.disabled ? -1 : 0"
        [attr.data-tab-id]="tab.tabId"
        class="tab"
      >
        <a href (click)="$event.preventDefault()" tabindex="-1" class="tab-link">
          <nb-icon *ngIf="tab.tabIcon" [config]="tab.tabIcon"></nb-icon>
          <ng-container
            *ngIf="tab.tabTitleDirective; else textTitleTemplate"
            [ngTemplateOutlet]="tab.tabTitleDirective.templateRef"
          ></ng-container>
          <ng-template #textTitleTemplate>
            <span class="tab-text">{{ tab.tabTitle }}</span>
          </ng-template>
        </a>
        <nb-badge
          *ngIf="tab.badgeText || tab.badgeDot"
          [text]="tab.badgeText"
          [dotMode]="tab.badgeDot"
          [status]="tab.badgeStatus"
          [position]="tab.badgePosition"
        >
        </nb-badge>
      </li>
    </ul>
    <ng-content select="nb-tab"></ng-content>
  `, styles: ["/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */:host{display:block}:host.full-width .tabset{justify-content:space-around}:host ::ng-deep nb-tab{flex:1;-ms-flex:1 1 auto;overflow:auto;display:none}:host ::ng-deep nb-tab.content-active{display:block}:host .tabset{display:flex;flex-direction:row;list-style-type:none;margin:0;padding:0}:host .tabset .tab{margin-bottom:-1px;text-align:center;position:relative}:host .tabset .tab.active a:before{display:block}:host .tabset .tab a{display:flex;position:relative;text-decoration:none}:host .tabset .tab a:before{position:absolute;content:\"\";width:100%;border-radius:3px;bottom:-2px;left:0}:host .tabset .tab a nb-icon{vertical-align:middle}[dir=ltr] :host .tabset .tab a nb-icon+span{margin-left:.5rem}[dir=rtl] :host .tabset .tab a nb-icon+span{margin-right:.5rem}\n"] }]
        }], ctorParameters: function () { return [{ type: i2.ActivatedRoute }, { type: i0.ChangeDetectorRef }]; }, propDecorators: { tabs: [{
                type: ContentChildren,
                args: [NbTabComponent]
            }], fullWidthValue: [{
                type: HostBinding,
                args: ['class.full-width']
            }], fullWidth: [{
                type: Input
            }], routeParam: [{
                type: Input
            }], changeTab: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidGFic2V0LmNvbXBvbmVudC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3NyYy9mcmFtZXdvcmsvdGhlbWUvY29tcG9uZW50cy90YWJzZXQvdGFic2V0LmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7OztHQUlHO0FBRUgsT0FBTyxFQUFFLEdBQUcsRUFBRSxLQUFLLEVBQUUsTUFBTSxFQUFFLFNBQVMsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBQy9ELE9BQU8sRUFDTCxTQUFTLEVBQ1QsS0FBSyxFQUNMLE1BQU0sRUFDTixZQUFZLEVBQ1osZUFBZSxFQUdmLFdBQVcsRUFFWCxZQUFZLEdBRWIsTUFBTSxlQUFlLENBQUM7QUFFdkIsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLE1BQU0sQ0FBQztBQUUvQixPQUFPLEVBQUUscUJBQXFCLEVBQWtCLE1BQU0sWUFBWSxDQUFDO0FBSW5FLE9BQU8sRUFBRSxxQkFBcUIsRUFBRSxNQUFNLHlCQUF5QixDQUFDO0FBQ2hFLE9BQU8sRUFBRSxtQkFBbUIsRUFBRSxNQUFNLHVCQUF1QixDQUFDOzs7Ozs7QUFFNUQ7Ozs7Ozs7Ozs7R0FVRztBQWNILE1BQU0sT0FBTyxjQUFjO0lBYjNCO1FBbUZFLGdCQUFXLEdBQVksS0FBSyxDQUFDO1FBRTdCLG9CQUFlLEdBQVksS0FBSyxDQUFDO1FBQ2pDLGtCQUFhLEdBQUcsS0FBSyxDQUFDO1FBb0N0Qjs7OztXQUlHO1FBQ00sZ0JBQVcsR0FBOEIsT0FBTyxDQUFDO1FBVzFEOzs7O1dBSUc7UUFDSCxTQUFJLEdBQVksS0FBSyxDQUFDO0tBQ3ZCO0lBbkhDOzs7T0FHRztJQUNILElBQ0ksUUFBUTtRQUNWLE9BQU8sSUFBSSxDQUFDLFNBQVMsQ0FBQztJQUN4QixDQUFDO0lBQ0QsSUFBSSxRQUFRLENBQUMsR0FBWTtRQUN2QixJQUFJLENBQUMsU0FBUyxHQUFHLHFCQUFxQixDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQzlD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LENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDO1NBQ2xDO0lBQ0gsQ0FBQzs7OEdBN0RVLGlCQUFpQjtrR0FBakIsaUJBQWlCLDhPQUNYLGNBQWMsNkJBdENyQjs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7R0FtQ1Q7MkZBRVUsaUJBQWlCO2tCQXhDN0IsU0FBUzsrQkFDRSxXQUFXLFlBRVg7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0dBbUNUO3FJQUdnQyxJQUFJO3NCQUFwQyxlQUFlO3VCQUFDLGNBQWM7Z0JBRy9CLGNBQWM7c0JBRGIsV0FBVzt1QkFBQyxrQkFBa0I7Z0JBUTNCLFNBQVM7c0JBRFosS0FBSztnQkFVRyxVQUFVO3NCQUFsQixLQUFLO2dCQU1JLFNBQVM7c0JBQWxCLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgQWt2ZW8uIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICovXG5cbmltcG9ydCB7IG1hcCwgZGVsYXksIGZpbHRlciwgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IHtcbiAgQ29tcG9uZW50LFxuICBJbnB1dCxcbiAgT3V0cHV0LFxuICBFdmVudEVtaXR0ZXIsXG4gIENvbnRlbnRDaGlsZHJlbixcbiAgUXVlcnlMaXN0LFxuICBBZnRlckNvbnRlbnRJbml0LFxuICBIb3N0QmluZGluZyxcbiAgQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gIENvbnRlbnRDaGlsZCxcbiAgT25EZXN0cm95LFxufSBmcm9tICdAYW5ndWxhci9jb3JlJztcbmltcG9ydCB7IEFjdGl2YXRlZFJvdXRlIH0gZnJvbSAnQGFuZ3VsYXIvcm91dGVyJztcbmltcG9ydCB7IFN1YmplY3QgfSBmcm9tICdyeGpzJztcblxuaW1wb3J0IHsgY29udmVydFRvQm9vbFByb3BlcnR5LCBOYkJvb2xlYW5JbnB1dCB9IGZyb20gJy4uL2hlbHBlcnMnO1xuaW1wb3J0IHsgTmJDb21wb25lbnRPckN1c3RvbVN0YXR1cyB9IGZyb20gJy4uL2NvbXBvbmVudC1zdGF0dXMnO1xuaW1wb3J0IHsgTmJCYWRnZVBvc2l0aW9uIH0gZnJvbSAnLi4vYmFkZ2UvYmFkZ2UuY29tcG9uZW50JztcbmltcG9ydCB7IE5iSWNvbkNvbmZpZyB9IGZyb20gJy4uL2ljb24vaWNvbi5jb21wb25lbnQnO1xuaW1wb3J0IHsgTmJUYWJDb250ZW50RGlyZWN0aXZlIH0gZnJvbSAnLi90YWItY29udGVudC5kaXJlY3RpdmUnO1xuaW1wb3J0IHsgTmJUYWJUaXRsZURpcmVjdGl2ZSB9IGZyb20gJy4vdGFiLXRpdGxlLmRpcmVjdGl2ZSc7XG5cbi8qKlxuICogU3BlY2lmaWMgdGFiIGNvbnRhaW5lci5cbiAqXG4gKiBgYGB0c1xuICogPG5iLXRhYiB0YWJUaXRsZT1cIlVzZXJzXCJcbiAqICAgYmFkZ2VUZXh0PVwiOTkrXCJcbiAqICAgYmFkZ2VTdGF0dXM9XCJkYW5nZXJcIj5cbiAqICAgPHA+TGlzdCBvZiA8c3Ryb25nPnVzZXJzPC9zdHJvbmc+LjwvcD5cbiAqIDwvbmItdGFiPlxuICogYGBgXG4gKi9cbkBDb21wb25lbnQoe1xuICBzZWxlY3RvcjogJ25iLXRhYicsXG4gIHRlbXBsYXRlOiBgXG4gICAgPG5nLWNvbnRhaW5lclxuICAgICAgKm5nSWY9XCJ0YWJDb250ZW50RGlyZWN0aXZlOyBlbHNlIHByb2plY3RlZENvbnRlbnRcIlxuICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwidGFiQ29udGVudERpcmVjdGl2ZS50ZW1wbGF0ZVJlZlwiXG4gICAgPjwvbmctY29udGFpbmVyPlxuXG4gICAgPG5nLXRlbXBsYXRlICNwcm9qZWN0ZWRDb250ZW50PlxuICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuICAgIDwvbmctdGVtcGxhdGU+XG4gIGAsXG59KVxuZXhwb3J0IGNsYXNzIE5iVGFiQ29tcG9uZW50IHtcbiAgQENvbnRlbnRDaGlsZChOYlRhYkNvbnRlbnREaXJlY3RpdmUpIHRhYkNvbnRlbnREaXJlY3RpdmU6IE5iVGFiQ29udGVudERpcmVjdGl2ZTtcbiAgQENvbnRlbnRDaGlsZChOYlRhYlRpdGxlRGlyZWN0aXZlKSB0YWJUaXRsZURpcmVjdGl2ZTogTmJUYWJUaXRsZURpcmVjdGl2ZTtcblxuICAvKipcbiAgICogVGFiIHRpdGxlXG4gICAqIEB0eXBlIHtzdHJpbmd9XG4gICAqL1xuICBASW5wdXQoKSB0YWJUaXRsZTogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBUYWIgaWRcbiAgICogQHR5cGUge3N0cmluZ31cbiAgICovXG4gIEBJbnB1dCgpIHRhYklkOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIFVzZSBiYWRnZSBkb3QgbW9kZVxuICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICovXG4gIEBJbnB1dCgpXG4gIGdldCBiYWRnZURvdCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5fYmFkZ2VEb3Q7XG4gIH1cbiAgc2V0IGJhZGdlRG90KHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMuX2JhZGdlRG90ID0gY29udmVydFRvQm9vbFByb3BlcnR5KHZhbCk7XG4gIH1cbiAgcHJvdGVjdGVkIF9iYWRnZURvdDogYm9vbGVhbjtcbiAgc3RhdGljIG5nQWNjZXB0SW5wdXRUeXBlX2JhZGdlRG90OiBOYkJvb2xlYW5JbnB1dDtcblxuICAvKipcbiAgICogVGFiIGljb24gbmFtZSBvciBpY29uIGNvbmZpZyBvYmplY3RcbiAgICogQHR5cGUge3N0cmluZyB8IE5iSWNvbkNvbmZpZ31cbiAgICovXG4gIEBJbnB1dCgpIHRhYkljb246IHN0cmluZyB8IE5iSWNvbkNvbmZpZztcblxuICAvKipcbiAgICogSXRlbSBpcyBkaXNhYmxlZCBhbmQgY2Fubm90IGJlIG9wZW5lZC5cbiAgICogQHR5cGUge2Jvb2xlYW59XG4gICAqL1xuICBASW5wdXQoJ2Rpc2FibGVkJylcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5kaXNhYmxlZCcpXG4gIGdldCBkaXNhYmxlZCgpOiBib29sZWFuIHtcbiAgICByZXR1cm4gdGhpcy5kaXNhYmxlZFZhbHVlO1xuICB9XG4gIHNldCBkaXNhYmxlZCh2YWw6IGJvb2xlYW4pIHtcbiAgICB0aGlzLmRpc2FibGVkVmFsdWUgPSBjb252ZXJ0VG9Cb29sUHJvcGVydHkodmFsKTtcbiAgfVxuICBzdGF0aWMgbmdBY2NlcHRJbnB1dFR5cGVfZGlzYWJsZWQ6IE5iQm9vbGVhbklucHV0O1xuXG4gIC8qKlxuICAgKiBTaG93IG9ubHkgaWNvbnMgd2hlbiB3aWR0aCBpcyBzbWFsbGVyIHRoYW4gYHRhYnMtaWNvbi1vbmx5LW1heC13aWR0aGBcbiAgICogQHR5cGUge2Jvb2xlYW59XG4gICAqL1xuICBASW5wdXQoKVxuICBzZXQgcmVzcG9uc2l2ZSh2YWw6IGJvb2xlYW4pIHtcbiAgICB0aGlzLnJlc3BvbnNpdmVWYWx1ZSA9IGNvbnZlcnRUb0Jvb2xQcm9wZXJ0eSh2YWwpO1xuICB9XG4gIGdldCByZXNwb25zaXZlKCkge1xuICAgIHJldHVybiB0aGlzLnJlc3BvbnNpdmVWYWx1ZTtcbiAgfVxuICBzdGF0aWMgbmdBY2NlcHRJbnB1dFR5cGVfcmVzcG9uc2l2ZTogTmJCb29sZWFuSW5wdXQ7XG5cbiAgLyoqXG4gICAqIE1ha2VzIHRoaXMgdGFiIGEgbGluayB0aGF0IGluaXRpYXRlcyBuYXZpZ2F0aW9uIHRvIGEgcm91dGVcbiAgICogQHR5cGUgc3RyaW5nXG4gICAqL1xuICBASW5wdXQoKSByb3V0ZTogc3RyaW5nO1xuXG4gIEBIb3N0QmluZGluZygnY2xhc3MuY29udGVudC1hY3RpdmUnKVxuICBhY3RpdmVWYWx1ZTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIHJlc3BvbnNpdmVWYWx1ZTogYm9vbGVhbiA9IGZhbHNlO1xuICBkaXNhYmxlZFZhbHVlID0gZmFsc2U7XG5cbiAgLyoqXG4gICAqIFNwZWNpZmllcyBhY3RpdmUgdGFiXG4gICAqIEByZXR1cm5zIHtib29sZWFufVxuICAgKi9cbiAgQElucHV0KClcbiAgZ2V0IGFjdGl2ZSgpIHtcbiAgICByZXR1cm4gdGhpcy5hY3RpdmVWYWx1ZTtcbiAgfVxuICBzZXQgYWN0aXZlKHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMuYWN0aXZlVmFsdWUgPSBjb252ZXJ0VG9Cb29sUHJvcGVydHkodmFsKTtcbiAgICBpZiAodGhpcy5hY3RpdmVWYWx1ZSkge1xuICAgICAgdGhpcy5pbml0ID0gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgc3RhdGljIG5nQWNjZXB0SW5wdXRUeXBlX2FjdGl2ZTogTmJCb29sZWFuSW5wdXQ7XG5cbiAgLyoqXG4gICAqIExhenkgbG9hZCBjb250ZW50IGJlZm9yZSB0YWIgc2VsZWN0aW9uXG4gICAqIEBkb2NzLXByaXZhdGVcbiAgICogQGRlcHJlY2F0ZWQgVGhpcyBzZXR0aW5nIG5ldmVyIHdvcmtlZC4gV3JhcCBjb250ZW50IGludG8gYSBgbmJUYWJDb250ZW50YCB0byBtYWtlIGl0IGxhenkuXG4gICAqIEBicmVha2luZy1jaGFuZ2UgUmVtb3ZlIDEyLjAuMFxuICAgKi9cbiAgQElucHV0KClcbiAgc2V0IGxhenlMb2FkKHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMuaW5pdCA9IGNvbnZlcnRUb0Jvb2xQcm9wZXJ0eSh2YWwpO1xuICB9XG4gIHN0YXRpYyBuZ0FjY2VwdElucHV0VHlwZV9sYXp5TG9hZDogTmJCb29sZWFuSW5wdXQ7XG5cbiAgLyoqXG4gICAqIEJhZGdlIHRleHQgdG8gZGlzcGxheVxuICAgKiBAdHlwZSBzdHJpbmdcbiAgICovXG4gIEBJbnB1dCgpIGJhZGdlVGV4dDogc3RyaW5nO1xuXG4gIC8qKlxuICAgKiBCYWRnZSBzdGF0dXMgKGFkZHMgc3BlY2lmaWMgc3R5bGVzKTpcbiAgICogJ3ByaW1hcnknLCAnaW5mbycsICdzdWNjZXNzJywgJ3dhcm5pbmcnLCAnZGFuZ2VyJ1xuICAgKiBAcGFyYW0ge3N0cmluZ30gdmFsXG4gICAqL1xuICBASW5wdXQoKSBiYWRnZVN0YXR1czogTmJDb21wb25lbnRPckN1c3RvbVN0YXR1cyA9ICdiYXNpYyc7XG5cbiAgLyoqXG4gICAqIEJhZGdlIHBvc2l0aW9uLlxuICAgKiBDYW4gYmUgc2V0IHRvIGFueSBjbGFzcyBvciB0byBvbmUgb2YgcHJlZGVmaW5lZCBwb3NpdGlvbnM6XG4gICAqICd0b3AgbGVmdCcsICd0b3AgcmlnaHQnLCAnYm90dG9tIGxlZnQnLCAnYm90dG9tIHJpZ2h0JyxcbiAgICogJ3RvcCBzdGFydCcsICd0b3AgZW5kJywgJ2JvdHRvbSBzdGFydCcsICdib3R0b20gZW5kJ1xuICAgKiBAdHlwZSBzdHJpbmdcbiAgICovXG4gIEBJbnB1dCgpIGJhZGdlUG9zaXRpb246IE5iQmFkZ2VQb3NpdGlvbjtcblxuICAvKipcbiAgICogQGRlcHJlY2F0ZWRcbiAgICogQGJyZWFraW5nLWNoYW5nZSBSZW1vdmUgMTIuMC4wXG4gICAqIEBkb2NzLXByaXZhdGVcbiAgICovXG4gIGluaXQ6IGJvb2xlYW4gPSBmYWxzZTtcbn1cblxuLy8gVE9ETzogQ29tYmluZSB0YWJzZXQgd2l0aCByb3V0ZS10YWJzZXQsIHNvIHRoYXQgd2UgY2FuOlxuLy8gLSBoYXZlIHNpbWlsYXIgaW50ZXJmYWNlXG4vLyAtIGVhc3kgdG8gbWlncmF0ZSBmcm9tIG9uZSB0byBhbm90aGVyXG4vLyAtIGNhbiBtaXggdGhlbSBib3RoIChyb3V0ZS9jb250ZW50IHRhYilcbi8qKlxuICpcbiAqIER5bmFtaWMgdGFic2V0IGNvbXBvbmVudC5cbiAqIEBzdGFja2VkLWV4YW1wbGUoU2hvd2Nhc2UsIHRhYnNldC90YWJzZXQtc2hvd2Nhc2UuY29tcG9uZW50KVxuICpcbiAqIEJhc2ljIHRhYnNldCBleGFtcGxlXG4gKlxuICogYGBgaHRtbFxuICogPG5iLXRhYnNldD5cbiAqICA8bmItdGFiIHRhYlRpdGxlPVwiU2ltcGxlIFRhYiAjMVwiPlxuICogICAgVGFiIGNvbnRlbnQgMVxuICogIDwvbmItdGFiPlxuICogIDxuYi10YWIgdGFiVGl0bGU9XCJTaW1wbGUgVGFiICMyXCI+XG4gKiAgICBUYWIgY29udGVudCAyXG4gKiAgPC9uYi10YWI+XG4gKiA8L25iLXRhYnNldD5cbiAqIGBgYFxuICpcbiAqICMjIyBJbnN0YWxsYXRpb25cbiAqXG4gKiBJbXBvcnQgYE5iVGFic2V0TW9kdWxlYCB0byB5b3VyIGZlYXR1cmUgbW9kdWxlLlxuICogYGBgdHNcbiAqIEBOZ01vZHVsZSh7XG4gKiAgIGltcG9ydHM6IFtcbiAqICAgICAvLyAuLi5cbiAqICAgICBOYlRhYnNldE1vZHVsZSxcbiAqICAgXSxcbiAqIH0pXG4gKiBleHBvcnQgY2xhc3MgUGFnZU1vZHVsZSB7IH1cbiAqIGBgYFxuICogIyMjIFVzYWdlXG4gKlxuICogSXQgaXMgYWxzbyBwb3NzaWJsZSB0byBzZXQgYSBiYWRnZSB0byBhIHBhcnRpY3VsYXIgdGFiOlxuICogQHN0YWNrZWQtZXhhbXBsZShUYWIgV2l0aCBCYWRnZSwgdGFic2V0L3RhYnNldC1iYWRnZS5jb21wb25lbnQpXG4gKlxuICogYW5kIHdlIGNhbiBzZXQgaXQgdG8gZnVsbCBhIHdpZHRoIG9mIGEgcGFyZW50IGNvbXBvbmVudFxuICogQHN0YWNrZWQtZXhhbXBsZShGdWxsIFdpZHRoLCB0YWJzZXQvdGFic2V0LXdpZHRoLmNvbXBvbmVudClcbiAqXG4gKiBgdGFiSWNvbmAgc2hvdWxkIGJlIHVzZWQgdG8gYWRkIGFuIGljb24gdG8gdGhlIHRhYi4gSWNvbiBjYW4gYWxzbyBiZSBjb21iaW5lZCB3aXRoIHRpdGxlLlxuICogYHJlc3BvbnNpdmVgIHRhYiBwcm9wZXJ0eSBpZiBzZXQgYWxsb3dzIHlvdSB0byBoaWRlIHRoZSB0aXRsZSBvbiBzbWFsbGVyIHNjcmVlbnNcbiAqIChgJHRhYnNldC10YWItdGV4dC1oaWRlLWJyZWFrcG9pbnRgIHZhcmlhYmxlKSBmb3IgYmV0dGVyIHJlc3BvbnNpdmUgYmVoYXZpb3VyLlxuICogWW91IGNhbiBvcGVuIHRoZSBmb2xsb3dpbmcgZXhhbXBsZSBhbmQgbWFrZVxuICogeW91ciBzY3JlZW4gc21hbGxlciAtIHRpdGxlcyB3aWxsIGJlIGhpZGRlbiBpbiB0aGUgbGFzdCB0YWJzZXQgaW4gdGhlIGxpc3Q6XG4gKiBAc3RhY2tlZC1leGFtcGxlKEljb24sIHRhYnNldC90YWJzZXQtaWNvbi5jb21wb25lbnQpXG4gKlxuICogSXQgaXMgYWxzbyBwb3NzaWJsZSB0byBkaXNhYmxlIGEgdGFiIHVzaW5nIGBkaXNhYmxlZGAgcHJvcGVydHk6XG4gKiBAc3RhY2tlZC1leGFtcGxlKERpc2FibGVkIFRhYiwgdGFic2V0L3RhYnNldC1kaXNhYmxlZC5jb21wb25lbnQpXG4gKlxuICogQnkgZGVmYXVsdCwgdGhlIHRhYiBjb250ZW50cyBpbnN0YW50aWF0ZWQgc3RyYWlnaHRhd2F5LiBUbyBtYWtlIHRhYiBjb250ZW50cyBsb2FkIGxhenksXG4gKiBkZWNsYXJlIHRoZSBib2R5IG9mIGEgdGFiIGluIGEgdGVtcGxhdGUgd2l0aCBgbmJUYWJDb250ZW50YCBkaXJlY3RpdmUuXG4gKiBgYGBodG1sXG4gKiA8bmItdGFic2V0PlxuICogICA8bmItdGFiPlxuICogICAgIDxzb21lLWNvbXBvbmVudCAqbmJUYWJDb250ZW50PkxhenkgY29udGVudDwvc29tZS1jb21wb25lbnQ+XG4gKiAgIDwvbmItdGFiPlxuICogICA8bmItdGFiPlxuICogICAgIDxuZy10ZW1wbGF0ZSBuYlRhYkNvbnRlbnQ+XG4gKiAgICAgICBMYXp5IGNvbnRlbnQgd2l0aCB0ZW1wbGF0ZSBzeW50YXhcbiAqICAgICA8L25nLXRlbXBsYXRlPlxuICogICA8L25iLXRhYj5cbiAqIDwvbmItdGFic2V0PlxuICogYGBgXG4gKlxuICogWW91IGNhbiBwcm92aWRlIGEgdGVtcGxhdGUgYXMgYSB0YWIgdGl0bGUgdmlhIGA8bmctdGVtcGxhdGUgbmJUYWJUaXRsZT5gOlxuICogQHN0YWNrZWQtZXhhbXBsZShUYWIgdGl0bGUgdGVtcGxhdGUsIHRhYnNldC90YWJzZXQtdGVtcGxhdGUtdGl0bGUuY29tcG9uZW50KVxuICpcbiAqIEBzdHlsZXNcbiAqXG4gKiB0YWJzZXQtYmFja2dyb3VuZC1jb2xvcjpcbiAqIHRhYnNldC1ib3JkZXItcmFkaXVzOlxuICogdGFic2V0LXNoYWRvdzpcbiAqIHRhYnNldC10YWItYmFja2dyb3VuZC1jb2xvcjpcbiAqIHRhYnNldC10YWItcGFkZGluZzpcbiAqIHRhYnNldC10YWItdGV4dC1jb2xvcjpcbiAqIHRhYnNldC10YWItdGV4dC1mb250LWZhbWlseTpcbiAqIHRhYnNldC10YWItdGV4dC1mb250LXNpemU6XG4gKiB0YWJzZXQtdGFiLXRleHQtZm9udC13ZWlnaHQ6XG4gKiB0YWJzZXQtdGFiLXRleHQtbGluZS1oZWlnaHQ6XG4gKiB0YWJzZXQtdGFiLXRleHQtdHJhbnNmb3JtOlxuICogdGFic2V0LXRhYi11bmRlcmxpbmUtd2lkdGg6XG4gKiB0YWJzZXQtdGFiLXVuZGVybGluZS1jb2xvcjpcbiAqIHRhYnNldC10YWItYWN0aXZlLWJhY2tncm91bmQtY29sb3I6XG4gKiB0YWJzZXQtdGFiLWFjdGl2ZS10ZXh0LWNvbG9yOlxuICogdGFic2V0LXRhYi1hY3RpdmUtdW5kZXJsaW5lLWNvbG9yOlxuICogdGFic2V0LXRhYi1mb2N1cy1iYWNrZ3JvdW5kLWNvbG9yOlxuICogdGFic2V0LXRhYi1mb2N1cy10ZXh0LWNvbG9yOlxuICogdGFic2V0LXRhYi1mb2N1cy11bmRlcmxpbmUtY29sb3I6XG4gKiB0YWJzZXQtdGFiLWhvdmVyLWJhY2tncm91bmQtY29sb3I6XG4gKiB0YWJzZXQtdGFiLWhvdmVyLXRleHQtY29sb3I6XG4gKiB0YWJzZXQtdGFiLWhvdmVyLXVuZGVybGluZS1jb2xvcjpcbiAqIHRhYnNldC10YWItZGlzYWJsZWQtYmFja2dyb3VuZC1jb2xvcjpcbiAqIHRhYnNldC10YWItZGlzYWJsZWQtdGV4dC1jb2xvcjpcbiAqIHRhYnNldC10YWItZGlzYWJsZWQtdW5kZXJsaW5lLWNvbG9yOlxuICogdGFic2V0LWRpdmlkZXItY29sb3I6XG4gKiB0YWJzZXQtZGl2aWRlci1zdHlsZTpcbiAqIHRhYnNldC1kaXZpZGVyLXdpZHRoOlxuICogdGFic2V0LWNvbnRlbnQtYmFja2dyb3VuZC1jb2xvcjpcbiAqIHRhYnNldC1jb250ZW50LXBhZGRpbmc6XG4gKiB0YWJzZXQtY29udGVudC10ZXh0LWNvbG9yOlxuICogdGFic2V0LWNvbnRlbnQtdGV4dC1mb250LWZhbWlseTpcbiAqIHRhYnNldC1jb250ZW50LXRleHQtZm9udC1zaXplOlxuICogdGFic2V0LWNvbnRlbnQtdGV4dC1mb250LXdlaWdodDpcbiAqIHRhYnNldC1jb250ZW50LXRleHQtbGluZS1oZWlnaHQ6XG4gKiB0YWJzZXQtc2Nyb2xsYmFyLWNvbG9yOlxuICogdGFic2V0LXNjcm9sbGJhci1iYWNrZ3JvdW5kLWNvbG9yOlxuICogdGFic2V0LXNjcm9sbGJhci13aWR0aDpcbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmItdGFic2V0JyxcbiAgc3R5bGVVcmxzOiBbJy4vdGFic2V0LmNvbXBvbmVudC5zY3NzJ10sXG4gIHRlbXBsYXRlOiBgXG4gICAgPHVsIGNsYXNzPVwidGFic2V0XCI+XG4gICAgICA8bGlcbiAgICAgICAgKm5nRm9yPVwibGV0IHRhYiBvZiB0YWJzXCJcbiAgICAgICAgKGNsaWNrKT1cInNlbGVjdFRhYih0YWIpXCJcbiAgICAgICAgKGtleXVwLnNwYWNlKT1cInNlbGVjdFRhYih0YWIpXCJcbiAgICAgICAgKGtleXVwLmVudGVyKT1cInNlbGVjdFRhYih0YWIpXCJcbiAgICAgICAgW2NsYXNzLnJlc3BvbnNpdmVdPVwidGFiLnJlc3BvbnNpdmVcIlxuICAgICAgICBbY2xhc3MuYWN0aXZlXT1cInRhYi5hY3RpdmVcIlxuICAgICAgICBbY2xhc3MuZGlzYWJsZWRdPVwidGFiLmRpc2FibGVkXCJcbiAgICAgICAgW2F0dHIudGFiaW5kZXhdPVwidGFiLmRpc2FibGVkID8gLTEgOiAwXCJcbiAgICAgICAgW2F0dHIuZGF0YS10YWItaWRdPVwidGFiLnRhYklkXCJcbiAgICAgICAgY2xhc3M9XCJ0YWJcIlxuICAgICAgPlxuICAgICAgICA8YSBocmVmIChjbGljayk9XCIkZXZlbnQucHJldmVudERlZmF1bHQoKVwiIHRhYmluZGV4PVwiLTFcIiBjbGFzcz1cInRhYi1saW5rXCI+XG4gICAgICAgICAgPG5iLWljb24gKm5nSWY9XCJ0YWIudGFiSWNvblwiIFtjb25maWddPVwidGFiLnRhYkljb25cIj48L25iLWljb24+XG4gICAgICAgICAgPG5nLWNvbnRhaW5lclxuICAgICAgICAgICAgKm5nSWY9XCJ0YWIudGFiVGl0bGVEaXJlY3RpdmU7IGVsc2UgdGV4dFRpdGxlVGVtcGxhdGVcIlxuICAgICAgICAgICAgW25nVGVtcGxhdGVPdXRsZXRdPVwidGFiLnRhYlRpdGxlRGlyZWN0aXZlLnRlbXBsYXRlUmVmXCJcbiAgICAgICAgICA+PC9uZy1jb250YWluZXI+XG4gICAgICAgICAgPG5nLXRlbXBsYXRlICN0ZXh0VGl0bGVUZW1wbGF0ZT5cbiAgICAgICAgICAgIDxzcGFuIGNsYXNzPVwidGFiLXRleHRcIj57eyB0YWIudGFiVGl0bGUgfX08L3NwYW4+XG4gICAgICAgICAgPC9uZy10ZW1wbGF0ZT5cbiAgICAgICAgPC9hPlxuICAgICAgICA8bmItYmFkZ2VcbiAgICAgICAgICAqbmdJZj1cInRhYi5iYWRnZVRleHQgfHwgdGFiLmJhZGdlRG90XCJcbiAgICAgICAgICBbdGV4dF09XCJ0YWIuYmFkZ2VUZXh0XCJcbiAgICAgICAgICBbZG90TW9kZV09XCJ0YWIuYmFkZ2VEb3RcIlxuICAgICAgICAgIFtzdGF0dXNdPVwidGFiLmJhZGdlU3RhdHVzXCJcbiAgICAgICAgICBbcG9zaXRpb25dPVwidGFiLmJhZGdlUG9zaXRpb25cIlxuICAgICAgICA+XG4gICAgICAgIDwvbmItYmFkZ2U+XG4gICAgICA8L2xpPlxuICAgIDwvdWw+XG4gICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwibmItdGFiXCI+PC9uZy1jb250ZW50PlxuICBgLFxufSlcbmV4cG9ydCBjbGFzcyBOYlRhYnNldENvbXBvbmVudCBpbXBsZW1lbnRzIEFmdGVyQ29udGVudEluaXQsIE9uRGVzdHJveSB7XG4gIEBDb250ZW50Q2hpbGRyZW4oTmJUYWJDb21wb25lbnQpIHRhYnM6IFF1ZXJ5TGlzdDxOYlRhYkNvbXBvbmVudD47XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5mdWxsLXdpZHRoJylcbiAgZnVsbFdpZHRoVmFsdWU6IGJvb2xlYW4gPSBmYWxzZTtcblxuICAvKipcbiAgICogVGFrZSBmdWxsIHdpZHRoIG9mIGEgcGFyZW50XG4gICAqIEBwYXJhbSB7Ym9vbGVhbn0gdmFsXG4gICAqL1xuICBASW5wdXQoKVxuICBzZXQgZnVsbFdpZHRoKHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMuZnVsbFdpZHRoVmFsdWUgPSBjb252ZXJ0VG9Cb29sUHJvcGVydHkodmFsKTtcbiAgfVxuICBzdGF0aWMgbmdBY2NlcHRJbnB1dFR5cGVfZnVsbFdpZHRoOiBOYkJvb2xlYW5JbnB1dDtcblxuICAvKipcbiAgICogSWYgc3BlY2lmaWVkIC0gdGFic2V0IGxpc3RlbnMgdG8gdGhpcyBwYXJhbWV0ZXIgYW5kIHNlbGVjdHMgY29ycmVzcG9uZGluZyB0YWIuXG4gICAqIEB0eXBlIHtzdHJpbmd9XG4gICAqL1xuICBASW5wdXQoKSByb3V0ZVBhcmFtOiBzdHJpbmc7XG5cbiAgLyoqXG4gICAqIEVtaXRzIHdoZW4gdGFiIGlzIHNlbGVjdGVkXG4gICAqIEB0eXBlIEV2ZW50RW1pdHRlcjxhbnk+XG4gICAqL1xuICBAT3V0cHV0KCkgY2hhbmdlVGFiID0gbmV3IEV2ZW50RW1pdHRlcjxhbnk+KCk7XG5cbiAgcHJpdmF0ZSBkZXN0cm95JDogU3ViamVjdDx2b2lkPiA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XG5cbiAgY29uc3RydWN0b3IocHJpdmF0ZSByb3V0ZTogQWN0aXZhdGVkUm91dGUsIHByaXZhdGUgY2hhbmdlRGV0ZWN0b3JSZWY6IENoYW5nZURldGVjdG9yUmVmKSB7fVxuXG4gIC8vIFRPRE86IHJlZmFjdG9yaW5nIHRoaXMgY29tcG9uZW50LCBhdm9pZCBjaGFuZ2UgZGV0ZWN0aW9uIGxvb3BcbiAgbmdBZnRlckNvbnRlbnRJbml0KCkge1xuICAgIHRoaXMucm91dGUucGFyYW1zXG4gICAgICAucGlwZShcbiAgICAgICAgbWFwKChwYXJhbXM6IGFueSkgPT5cbiAgICAgICAgICB0aGlzLnRhYnMuZmluZCgodGFiKSA9PiAodGhpcy5yb3V0ZVBhcmFtID8gdGFiLnJvdXRlID09PSBwYXJhbXNbdGhpcy5yb3V0ZVBhcmFtXSA6IHRhYi5hY3RpdmUpKSxcbiAgICAgICAgKSxcbiAgICAgICAgZGVsYXkoMCksXG4gICAgICAgIG1hcCgodGFiOiBOYlRhYkNvbXBvbmVudCkgPT4gdGFiIHx8IHRoaXMudGFicy5maXJzdCksXG4gICAgICAgIGZpbHRlcigodGFiOiBOYlRhYkNvbXBvbmVudCkgPT4gISF0YWIpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JCksXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCh0YWJUb1NlbGVjdDogTmJUYWJDb21wb25lbnQpID0+IHtcbiAgICAgICAgdGhpcy5zZWxlY3RUYWIodGFiVG9TZWxlY3QpO1xuICAgICAgICB0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuICAgICAgfSk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpOiB2b2lkIHtcbiAgICB0aGlzLmRlc3Ryb3kkLm5leHQoKTtcbiAgICB0aGlzLmRlc3Ryb3kkLmNvbXBsZXRlKCk7XG4gIH1cblxuICAvLyBUT0RPOiBuYXZpZ2F0ZSB0byByb3V0ZVBhcmFtXG4gIHNlbGVjdFRhYihzZWxlY3RlZFRhYjogTmJUYWJDb21wb25lbnQpIHtcbiAgICBpZiAoIXNlbGVjdGVkVGFiLmRpc2FibGVkKSB7XG4gICAgICB0aGlzLnRhYnMuZm9yRWFjaCgodGFiKSA9PiAodGFiLmFjdGl2ZSA9IHRhYiA9PT0gc2VsZWN0ZWRUYWIpKTtcbiAgICAgIHRoaXMuY2hhbmdlVGFiLmVtaXQoc2VsZWN0ZWRUYWIpO1xuICAgIH1cbiAgfVxufVxuIl19