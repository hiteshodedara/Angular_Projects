/**
 * @license
 * Copyright Akveo. All Rights Reserved.
 * Licensed under the MIT License. See License.txt in the project root for license information.
 */
import { ChangeDetectionStrategy, Component, EventEmitter, HostBinding, Input, Output, } from '@angular/core';
import { combineLatest, Subject } from 'rxjs';
import { takeUntil, filter, map, startWith } from 'rxjs/operators';
import { convertToBoolProperty } from '../helpers';
import { getSidebarState$, getSidebarResponsiveState$ } from './sidebar.service';
import * as i0 from "@angular/core";
import * as i1 from "./sidebar.service";
import * as i2 from "../../services/theme.service";
/**
 * Sidebar header container.
 *
 * Placeholder which contains a sidebar header content,
 * placed at the very top of the sidebar outside of the scroll area.
 */
export class NbSidebarHeaderComponent {
}
NbSidebarHeaderComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: NbSidebarHeaderComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
NbSidebarHeaderComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.4", type: NbSidebarHeaderComponent, selector: "nb-sidebar-header", ngImport: i0, template: ` <ng-content></ng-content> `, isInline: true });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: NbSidebarHeaderComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'nb-sidebar-header',
                    template: ` <ng-content></ng-content> `,
                }]
        }] });
/**
 * Sidebar footer container.
 *
 * Placeholder which contains a sidebar footer content,
 * placed at the very bottom of the sidebar outside of the scroll area.
 */
export class NbSidebarFooterComponent {
}
NbSidebarFooterComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: NbSidebarFooterComponent, deps: [], target: i0.ɵɵFactoryTarget.Component });
NbSidebarFooterComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.4", type: NbSidebarFooterComponent, selector: "nb-sidebar-footer", ngImport: i0, template: ` <ng-content></ng-content> `, isInline: true });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: NbSidebarFooterComponent, decorators: [{
            type: Component,
            args: [{
                    selector: 'nb-sidebar-footer',
                    template: ` <ng-content></ng-content> `,
                }]
        }] });
/**
 * Layout sidebar component.
 *
 * @stacked-example(Showcase, sidebar/sidebar-showcase.component)
 *
 * ### Installation
 *
 * Import `NbSidebarModule.forRoot()` to your app module.
 * ```ts
 * @NgModule({
 *   imports: [
 *     // ...
 *     NbSidebarModule.forRoot(),
 *   ],
 * })
 * export class AppModule { }
 * ```
 * and `NbSidebarModule` to your feature module where the component should be shown:
 * ```ts
 * @NgModule({
 *   imports: [
 *     // ...
 *     NbSidebarModule,
 *   ],
 * })
 * export class PageModule { }
 * ```
 * ### Usage
 *
 * Sidebar can be placed on the left or the right side of the layout,
 * or on start/end position of layout (depends on document direction, left to right or right to left)
 * It can be fixed (shown above the content) or can push the layout when opened.
 *
 * There are three states - `expanded`, `collapsed`, `compacted`.
 * By default sidebar content is fixed and saves its position while the page is being scrolled.
 *
 * Compacted sidebar example:
 * @stacked-example(Compacted Sidebar, sidebar/sidebar-compacted.component)
 *
 * Sidebar also supports a `responsive` behavior, listening to window size change and changing its size respectably.
 *
 * In a pair with header it is possible to setup a configuration when header is placed on a side of the sidebar
 * and not on top of it. To achieve this simply put a `subheader` property to the header like this:
 * ```html
 * <nb-layout-header subheader></nb-layout-header>
 * ```
 * @stacked-example(Subheader, layout/layout-sidebar-subheader.component)
 * Note that in such configuration sidebar shadow is removed and header cannot be make `fixed`.
 *
 * @additional-example(Right Sidebar, sidebar/sidebar-right.component)
 * @additional-example(Fixed Sidebar, sidebar/sidebar-fixed.component)
 *
 * @styles
 *
 * sidebar-background-color:
 * sidebar-text-color:
 * sidebar-text-font-family:
 * sidebar-text-font-size:
 * sidebar-text-font-weight:
 * sidebar-text-line-height:
 * sidebar-height:
 * sidebar-width:
 * sidebar-width-compact:
 * sidebar-padding:
 * sidebar-header-height:
 * sidebar-footer-height:
 * sidebar-shadow:
 * sidebar-menu-item-highlight-color:
 * sidebar-scrollbar-background-color:
 * sidebar-scrollbar-color:
 * sidebar-scrollbar-width:
 */
export class NbSidebarComponent {
    get expanded() {
        return this.state === 'expanded';
    }
    get collapsed() {
        return this.state === 'collapsed';
    }
    get compacted() {
        return this.state === 'compacted';
    }
    /**
     * Places sidebar on the right side
     * @type {boolean}
     */
    set right(val) {
        this.rightValue = convertToBoolProperty(val);
        this.leftValue = !this.rightValue;
        this.startValue = false;
        this.endValue = false;
    }
    /**
     * Places sidebar on the left side
     * @type {boolean}
     */
    set left(val) {
        this.leftValue = convertToBoolProperty(val);
        this.rightValue = !this.leftValue;
        this.startValue = false;
        this.endValue = false;
    }
    /**
     * Places sidebar on the start edge of layout
     * @type {boolean}
     */
    set start(val) {
        this.startValue = convertToBoolProperty(val);
        this.endValue = !this.startValue;
        this.leftValue = false;
        this.rightValue = false;
    }
    /**
     * Places sidebar on the end edge of layout
     * @type {boolean}
     */
    set end(val) {
        this.endValue = convertToBoolProperty(val);
        this.startValue = !this.endValue;
        this.leftValue = false;
        this.rightValue = false;
    }
    /**
     * Makes sidebar fixed (shown above the layout content)
     * @type {boolean}
     */
    set fixed(val) {
        this.fixedValue = convertToBoolProperty(val);
    }
    /**
     * Makes sidebar container fixed
     * @type {boolean}
     */
    set containerFixed(val) {
        this.containerFixedValue = convertToBoolProperty(val);
    }
    /**
     * Initial sidebar state, `expanded`|`collapsed`|`compacted`
     * @type {string}
     */
    get state() {
        return this._state;
    }
    set state(value) {
        this._state = value;
    }
    /**
     * Makes sidebar listen to media query events and change its behaviour
     * @type {boolean}
     */
    get responsive() {
        return this._responsive;
    }
    set responsive(value) {
        if (this.responsive !== convertToBoolProperty(value)) {
            this._responsive = !this.responsive;
            this.responsiveValueChange$.next(this.responsive);
        }
    }
    constructor(sidebarService, themeService, element, cd) {
        this.sidebarService = sidebarService;
        this.themeService = themeService;
        this.element = element;
        this.cd = cd;
        this.responsiveValueChange$ = new Subject();
        this.responsiveState = 'pc';
        this.destroy$ = new Subject();
        this.containerFixedValue = true;
        this.fixedValue = false;
        this.rightValue = false;
        this.leftValue = true;
        this.startValue = false;
        this.endValue = false;
        this._state = 'expanded';
        this._responsive = false;
        // TODO: get width by the key and define only max width for the tablets and mobiles
        /**
         * Controls on which screen sizes sidebar should be switched to compacted state.
         * Works only when responsive mode is on.
         * Default values are `['xs', 'is', 'sm', 'md', 'lg']`.
         *
         * @type string[]
         */
        this.compactedBreakpoints = ['xs', 'is', 'sm', 'md', 'lg'];
        /**
         * Controls on which screen sizes sidebar should be switched to collapsed state.
         * Works only when responsive mode is on.
         * Default values are `['xs', 'is']`.
         *
         * @type string[]
         */
        this.collapsedBreakpoints = ['xs', 'is'];
        /**
         * Emits whenever sidebar state change.
         */
        this.stateChange = new EventEmitter();
        /**
         * Emits whenever sidebar responsive state change.
         */
        this.responsiveStateChange = new EventEmitter();
    }
    ngOnInit() {
        this.sidebarService
            .onToggle()
            .pipe(filter(({ tag }) => !this.tag || this.tag === tag), takeUntil(this.destroy$))
            .subscribe(({ compact }) => this.toggle(compact));
        this.sidebarService
            .onExpand()
            .pipe(filter(({ tag }) => !this.tag || this.tag === tag), takeUntil(this.destroy$))
            .subscribe(() => this.expand());
        this.sidebarService
            .onCollapse()
            .pipe(filter(({ tag }) => !this.tag || this.tag === tag), takeUntil(this.destroy$))
            .subscribe(() => this.collapse());
        this.sidebarService
            .onCompact()
            .pipe(filter(({ tag }) => !this.tag || this.tag === tag), takeUntil(this.destroy$))
            .subscribe(() => this.compact());
        getSidebarState$
            .pipe(filter(({ tag }) => !this.tag || this.tag === tag), takeUntil(this.destroy$))
            .subscribe(({ observer }) => observer.next(this.state));
        getSidebarResponsiveState$
            .pipe(filter(({ tag }) => !this.tag || this.tag === tag), takeUntil(this.destroy$))
            .subscribe(({ observer }) => observer.next(this.responsiveState));
        this.responsiveValueChange$
            .pipe(filter((responsive) => !responsive), takeUntil(this.destroy$))
            .subscribe(() => this.expand());
        this.subscribeToMediaQueryChange();
    }
    ngOnDestroy() {
        this.destroy$.next();
        this.destroy$.complete();
    }
    // TODO: this is more of a workaround, should be a better way to make components communicate to each other
    onClick(event) {
        const menu = this.element.nativeElement.querySelector('nb-menu');
        if (menu && menu.contains(event.target)) {
            const link = this.getMenuLink(event.target);
            if (link && link.nextElementSibling && link.nextElementSibling.classList.contains('menu-items')) {
                this.sidebarService.expand(this.tag);
            }
        }
    }
    /**
     * Collapses the sidebar
     */
    collapse() {
        this.updateState('collapsed');
    }
    /**
     * Expands the sidebar
     */
    expand() {
        this.updateState('expanded');
    }
    /**
     * Compacts the sidebar (minimizes)
     */
    compact() {
        this.updateState('compacted');
    }
    /**
     * Toggles sidebar state (expanded|collapsed|compacted)
     * @param {boolean} compact If true, then sidebar state will be changed between expanded & compacted,
     * otherwise - between expanded & collapsed. False by default.
     *
     * Toggle sidebar state
     *
     * ```ts
     * this.sidebar.toggle(true);
     * ```
     */
    toggle(compact = false) {
        if (this.responsive) {
            if (this.responsiveState === 'mobile') {
                compact = false;
            }
        }
        if (this.state === 'compacted' || this.state === 'collapsed') {
            this.updateState('expanded');
        }
        else {
            this.updateState(compact ? 'compacted' : 'collapsed');
        }
    }
    subscribeToMediaQueryChange() {
        combineLatest([
            this.responsiveValueChange$.pipe(startWith(this.responsive)),
            this.themeService.onMediaQueryChange(),
        ])
            .pipe(filter(([responsive]) => responsive), map(([, breakpoints]) => breakpoints), takeUntil(this.destroy$))
            .subscribe(([prev, current]) => {
            const isCollapsed = this.collapsedBreakpoints.includes(current.name);
            const isCompacted = this.compactedBreakpoints.includes(current.name);
            let newResponsiveState;
            if (isCompacted) {
                this.fixed = this.containerFixedValue;
                this.compact();
                newResponsiveState = 'tablet';
            }
            if (isCollapsed) {
                this.fixed = true;
                this.collapse();
                newResponsiveState = 'mobile';
            }
            if (!isCollapsed && !isCompacted && (!prev.width || prev.width < current.width)) {
                this.expand();
                this.fixed = false;
                newResponsiveState = 'pc';
            }
            if (newResponsiveState && newResponsiveState !== this.responsiveState) {
                this.responsiveState = newResponsiveState;
                this.responsiveStateChange.emit(this.responsiveState);
                this.cd.markForCheck();
            }
        });
    }
    getMenuLink(element) {
        if (!element || element.tagName.toLowerCase() === 'nb-menu') {
            return undefined;
        }
        if (element.tagName.toLowerCase() === 'a') {
            return element;
        }
        return this.getMenuLink(element.parentElement);
    }
    updateState(state) {
        if (this.state !== state) {
            this.state = state;
            this.stateChange.emit(this.state);
            this.cd.markForCheck();
        }
    }
}
NbSidebarComponent.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: NbSidebarComponent, deps: [{ token: i1.NbSidebarService }, { token: i2.NbThemeService }, { token: i0.ElementRef }, { token: i0.ChangeDetectorRef }], target: i0.ɵɵFactoryTarget.Component });
NbSidebarComponent.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "15.2.4", type: NbSidebarComponent, selector: "nb-sidebar", inputs: { right: "right", left: "left", start: "start", end: "end", fixed: "fixed", containerFixed: "containerFixed", state: "state", responsive: "responsive", tag: "tag", compactedBreakpoints: "compactedBreakpoints", collapsedBreakpoints: "collapsedBreakpoints" }, outputs: { stateChange: "stateChange", responsiveStateChange: "responsiveStateChange" }, host: { properties: { "class.fixed": "this.fixedValue", "class.right": "this.rightValue", "class.left": "this.leftValue", "class.start": "this.startValue", "class.end": "this.endValue", "class.expanded": "this.expanded", "class.collapsed": "this.collapsed", "class.compacted": "this.compacted" } }, ngImport: i0, template: `
    <div class="main-container" [class.main-container-fixed]="containerFixedValue">
      <ng-content select="nb-sidebar-header"></ng-content>
      <div class="scrollable" (click)="onClick($event)">
        <ng-content></ng-content>
      </div>
      <ng-content select="nb-sidebar-footer"></ng-content>
    </div>
  `, isInline: true, styles: ["/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */:host{display:flex;flex-direction:column;overflow:hidden;z-index:auto;order:0}:host .scrollable{overflow-y:auto;overflow-x:hidden;flex:1}:host .main-container{transform:translateZ(0);display:flex;flex-direction:column}:host .main-container-fixed{position:fixed}:host.right{margin-right:0;margin-left:auto}[dir=ltr] :host.right{order:4}[dir=rtl] :host.right{order:0}:host.end{order:4}[dir=ltr] :host.end{margin-right:0;margin-left:auto}[dir=rtl] :host.end{margin-left:0;margin-right:auto}:host.fixed{position:fixed;height:100%;z-index:999;top:0;bottom:0;left:0}:host.fixed.right{right:0}[dir=ltr] :host.fixed.start{left:0}[dir=rtl] :host.fixed.start{right:0}[dir=ltr] :host.fixed.end{right:0}[dir=rtl] :host.fixed.end{left:0}:host ::ng-deep nb-sidebar-footer{margin-top:auto;display:block}:host ::ng-deep nb-sidebar-header{display:block}\n"], changeDetection: i0.ChangeDetectionStrategy.OnPush });
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "15.2.4", ngImport: i0, type: NbSidebarComponent, decorators: [{
            type: Component,
            args: [{ selector: 'nb-sidebar', template: `
    <div class="main-container" [class.main-container-fixed]="containerFixedValue">
      <ng-content select="nb-sidebar-header"></ng-content>
      <div class="scrollable" (click)="onClick($event)">
        <ng-content></ng-content>
      </div>
      <ng-content select="nb-sidebar-footer"></ng-content>
    </div>
  `, changeDetection: ChangeDetectionStrategy.OnPush, styles: ["/**\n * @license\n * Copyright Akveo. All Rights Reserved.\n * Licensed under the MIT License. See License.txt in the project root for license information.\n */:host{display:flex;flex-direction:column;overflow:hidden;z-index:auto;order:0}:host .scrollable{overflow-y:auto;overflow-x:hidden;flex:1}:host .main-container{transform:translateZ(0);display:flex;flex-direction:column}:host .main-container-fixed{position:fixed}:host.right{margin-right:0;margin-left:auto}[dir=ltr] :host.right{order:4}[dir=rtl] :host.right{order:0}:host.end{order:4}[dir=ltr] :host.end{margin-right:0;margin-left:auto}[dir=rtl] :host.end{margin-left:0;margin-right:auto}:host.fixed{position:fixed;height:100%;z-index:999;top:0;bottom:0;left:0}:host.fixed.right{right:0}[dir=ltr] :host.fixed.start{left:0}[dir=rtl] :host.fixed.start{right:0}[dir=ltr] :host.fixed.end{right:0}[dir=rtl] :host.fixed.end{left:0}:host ::ng-deep nb-sidebar-footer{margin-top:auto;display:block}:host ::ng-deep nb-sidebar-header{display:block}\n"] }]
        }], ctorParameters: function () { return [{ type: i1.NbSidebarService }, { type: i2.NbThemeService }, { type: i0.ElementRef }, { type: i0.ChangeDetectorRef }]; }, propDecorators: { fixedValue: [{
                type: HostBinding,
                args: ['class.fixed']
            }], rightValue: [{
                type: HostBinding,
                args: ['class.right']
            }], leftValue: [{
                type: HostBinding,
                args: ['class.left']
            }], startValue: [{
                type: HostBinding,
                args: ['class.start']
            }], endValue: [{
                type: HostBinding,
                args: ['class.end']
            }], expanded: [{
                type: HostBinding,
                args: ['class.expanded']
            }], collapsed: [{
                type: HostBinding,
                args: ['class.collapsed']
            }], compacted: [{
                type: HostBinding,
                args: ['class.compacted']
            }], right: [{
                type: Input
            }], left: [{
                type: Input
            }], start: [{
                type: Input
            }], end: [{
                type: Input
            }], fixed: [{
                type: Input
            }], containerFixed: [{
                type: Input
            }], state: [{
                type: Input
            }], responsive: [{
                type: Input
            }], tag: [{
                type: Input
            }], compactedBreakpoints: [{
                type: Input
            }], collapsedBreakpoints: [{
                type: Input
            }], stateChange: [{
                type: Output
            }], responsiveStateChange: [{
                type: Output
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2lkZWJhci5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi9zcmMvZnJhbWV3b3JrL3RoZW1lL2NvbXBvbmVudHMvc2lkZWJhci9zaWRlYmFyLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7OztHQUlHO0FBRUgsT0FBTyxFQUNMLHVCQUF1QixFQUV2QixTQUFTLEVBRVQsWUFBWSxFQUNaLFdBQVcsRUFDWCxLQUFLLEVBR0wsTUFBTSxHQUNQLE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxhQUFhLEVBQWMsT0FBTyxFQUFFLE1BQU0sTUFBTSxDQUFDO0FBQzFELE9BQU8sRUFBRSxTQUFTLEVBQUUsTUFBTSxFQUFFLEdBQUcsRUFBRSxTQUFTLEVBQUUsTUFBTSxnQkFBZ0IsQ0FBQztBQUVuRSxPQUFPLEVBQUUscUJBQXFCLEVBQWtCLE1BQU0sWUFBWSxDQUFDO0FBR25FLE9BQU8sRUFBb0IsZ0JBQWdCLEVBQUUsMEJBQTBCLEVBQUUsTUFBTSxtQkFBbUIsQ0FBQzs7OztBQUtuRzs7Ozs7R0FLRztBQUtILE1BQU0sT0FBTyx3QkFBd0I7O3FIQUF4Qix3QkFBd0I7eUdBQXhCLHdCQUF3Qix5REFGekIsNkJBQTZCOzJGQUU1Qix3QkFBd0I7a0JBSnBDLFNBQVM7bUJBQUM7b0JBQ1QsUUFBUSxFQUFFLG1CQUFtQjtvQkFDN0IsUUFBUSxFQUFFLDZCQUE2QjtpQkFDeEM7O0FBR0Q7Ozs7O0dBS0c7QUFLSCxNQUFNLE9BQU8sd0JBQXdCOztxSEFBeEIsd0JBQXdCO3lHQUF4Qix3QkFBd0IseURBRnpCLDZCQUE2QjsyRkFFNUIsd0JBQXdCO2tCQUpwQyxTQUFTO21CQUFDO29CQUNULFFBQVEsRUFBRSxtQkFBbUI7b0JBQzdCLFFBQVEsRUFBRSw2QkFBNkI7aUJBQ3hDOztBQUdEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7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QUFFLENBQUM7U0FDeEI7SUFDSCxDQUFDOzsrR0FoV1Usa0JBQWtCO21HQUFsQixrQkFBa0IsZ3NCQVhuQjs7Ozs7Ozs7R0FRVDsyRkFHVSxrQkFBa0I7a0JBZDlCLFNBQVM7K0JBQ0UsWUFBWSxZQUVaOzs7Ozs7OztHQVFULG1CQUNnQix1QkFBdUIsQ0FBQyxNQUFNOzZMQVVuQixVQUFVO3NCQUFyQyxXQUFXO3VCQUFDLGFBQWE7Z0JBQ0UsVUFBVTtzQkFBckMsV0FBVzt1QkFBQyxhQUFhO2dCQUNDLFNBQVM7c0JBQW5DLFdBQVc7dUJBQUMsWUFBWTtnQkFDRyxVQUFVO3NCQUFyQyxXQUFXO3VCQUFDLGFBQWE7Z0JBQ0EsUUFBUTtzQkFBakMsV0FBVzt1QkFBQyxXQUFXO2dCQUdwQixRQUFRO3NCQURYLFdBQVc7dUJBQUMsZ0JBQWdCO2dCQUt6QixTQUFTO3NCQURaLFdBQVc7dUJBQUMsaUJBQWlCO2dCQUsxQixTQUFTO3NCQURaLFdBQVc7dUJBQUMsaUJBQWlCO2dCQVUxQixLQUFLO3NCQURSLEtBQUs7Z0JBY0YsSUFBSTtzQkFEUCxLQUFLO2dCQWNGLEtBQUs7c0JBRFIsS0FBSztnQkFjRixHQUFHO3NCQUROLEtBQUs7Z0JBY0YsS0FBSztzQkFEUixLQUFLO2dCQVdGLGNBQWM7c0JBRGpCLEtBQUs7Z0JBV0YsS0FBSztzQkFEUixLQUFLO2dCQWNGLFVBQVU7c0JBRGIsS0FBSztnQkFtQkcsR0FBRztzQkFBWCxLQUFLO2dCQVVHLG9CQUFvQjtzQkFBNUIsS0FBSztnQkFTRyxvQkFBb0I7c0JBQTVCLEtBQUs7Z0JBS2EsV0FBVztzQkFBN0IsTUFBTTtnQkFLWSxxQkFBcUI7c0JBQXZDLE1BQU0iLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBsaWNlbnNlXG4gKiBDb3B5cmlnaHQgQWt2ZW8uIEFsbCBSaWdodHMgUmVzZXJ2ZWQuXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgTUlUIExpY2Vuc2UuIFNlZSBMaWNlbnNlLnR4dCBpbiB0aGUgcHJvamVjdCByb290IGZvciBsaWNlbnNlIGluZm9ybWF0aW9uLlxuICovXG5cbmltcG9ydCB7XG4gIENoYW5nZURldGVjdGlvblN0cmF0ZWd5LFxuICBDaGFuZ2VEZXRlY3RvclJlZixcbiAgQ29tcG9uZW50LFxuICBFbGVtZW50UmVmLFxuICBFdmVudEVtaXR0ZXIsXG4gIEhvc3RCaW5kaW5nLFxuICBJbnB1dCxcbiAgT25EZXN0cm95LFxuICBPbkluaXQsXG4gIE91dHB1dCxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBjb21iaW5lTGF0ZXN0LCBPYnNlcnZhYmxlLCBTdWJqZWN0IH0gZnJvbSAncnhqcyc7XG5pbXBvcnQgeyB0YWtlVW50aWwsIGZpbHRlciwgbWFwLCBzdGFydFdpdGggfSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbmltcG9ydCB7IGNvbnZlcnRUb0Jvb2xQcm9wZXJ0eSwgTmJCb29sZWFuSW5wdXQgfSBmcm9tICcuLi9oZWxwZXJzJztcbmltcG9ydCB7IE5iVGhlbWVTZXJ2aWNlIH0gZnJvbSAnLi4vLi4vc2VydmljZXMvdGhlbWUuc2VydmljZSc7XG5pbXBvcnQgeyBOYk1lZGlhQnJlYWtwb2ludCB9IGZyb20gJy4uLy4uL3NlcnZpY2VzL2JyZWFrcG9pbnRzLnNlcnZpY2UnO1xuaW1wb3J0IHsgTmJTaWRlYmFyU2VydmljZSwgZ2V0U2lkZWJhclN0YXRlJCwgZ2V0U2lkZWJhclJlc3BvbnNpdmVTdGF0ZSQgfSBmcm9tICcuL3NpZGViYXIuc2VydmljZSc7XG5cbmV4cG9ydCB0eXBlIE5iU2lkZWJhclN0YXRlID0gJ2V4cGFuZGVkJyB8ICdjb2xsYXBzZWQnIHwgJ2NvbXBhY3RlZCc7XG5leHBvcnQgdHlwZSBOYlNpZGViYXJSZXNwb25zaXZlU3RhdGUgPSAnbW9iaWxlJyB8ICd0YWJsZXQnIHwgJ3BjJztcblxuLyoqXG4gKiBTaWRlYmFyIGhlYWRlciBjb250YWluZXIuXG4gKlxuICogUGxhY2Vob2xkZXIgd2hpY2ggY29udGFpbnMgYSBzaWRlYmFyIGhlYWRlciBjb250ZW50LFxuICogcGxhY2VkIGF0IHRoZSB2ZXJ5IHRvcCBvZiB0aGUgc2lkZWJhciBvdXRzaWRlIG9mIHRoZSBzY3JvbGwgYXJlYS5cbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmItc2lkZWJhci1oZWFkZXInLFxuICB0ZW1wbGF0ZTogYCA8bmctY29udGVudD48L25nLWNvbnRlbnQ+IGAsXG59KVxuZXhwb3J0IGNsYXNzIE5iU2lkZWJhckhlYWRlckNvbXBvbmVudCB7fVxuXG4vKipcbiAqIFNpZGViYXIgZm9vdGVyIGNvbnRhaW5lci5cbiAqXG4gKiBQbGFjZWhvbGRlciB3aGljaCBjb250YWlucyBhIHNpZGViYXIgZm9vdGVyIGNvbnRlbnQsXG4gKiBwbGFjZWQgYXQgdGhlIHZlcnkgYm90dG9tIG9mIHRoZSBzaWRlYmFyIG91dHNpZGUgb2YgdGhlIHNjcm9sbCBhcmVhLlxuICovXG5AQ29tcG9uZW50KHtcbiAgc2VsZWN0b3I6ICduYi1zaWRlYmFyLWZvb3RlcicsXG4gIHRlbXBsYXRlOiBgIDxuZy1jb250ZW50PjwvbmctY29udGVudD4gYCxcbn0pXG5leHBvcnQgY2xhc3MgTmJTaWRlYmFyRm9vdGVyQ29tcG9uZW50IHt9XG5cbi8qKlxuICogTGF5b3V0IHNpZGViYXIgY29tcG9uZW50LlxuICpcbiAqIEBzdGFja2VkLWV4YW1wbGUoU2hvd2Nhc2UsIHNpZGViYXIvc2lkZWJhci1zaG93Y2FzZS5jb21wb25lbnQpXG4gKlxuICogIyMjIEluc3RhbGxhdGlvblxuICpcbiAqIEltcG9ydCBgTmJTaWRlYmFyTW9kdWxlLmZvclJvb3QoKWAgdG8geW91ciBhcHAgbW9kdWxlLlxuICogYGBgdHNcbiAqIEBOZ01vZHVsZSh7XG4gKiAgIGltcG9ydHM6IFtcbiAqICAgICAvLyAuLi5cbiAqICAgICBOYlNpZGViYXJNb2R1bGUuZm9yUm9vdCgpLFxuICogICBdLFxuICogfSlcbiAqIGV4cG9ydCBjbGFzcyBBcHBNb2R1bGUgeyB9XG4gKiBgYGBcbiAqIGFuZCBgTmJTaWRlYmFyTW9kdWxlYCB0byB5b3VyIGZlYXR1cmUgbW9kdWxlIHdoZXJlIHRoZSBjb21wb25lbnQgc2hvdWxkIGJlIHNob3duOlxuICogYGBgdHNcbiAqIEBOZ01vZHVsZSh7XG4gKiAgIGltcG9ydHM6IFtcbiAqICAgICAvLyAuLi5cbiAqICAgICBOYlNpZGViYXJNb2R1bGUsXG4gKiAgIF0sXG4gKiB9KVxuICogZXhwb3J0IGNsYXNzIFBhZ2VNb2R1bGUgeyB9XG4gKiBgYGBcbiAqICMjIyBVc2FnZVxuICpcbiAqIFNpZGViYXIgY2FuIGJlIHBsYWNlZCBvbiB0aGUgbGVmdCBvciB0aGUgcmlnaHQgc2lkZSBvZiB0aGUgbGF5b3V0LFxuICogb3Igb24gc3RhcnQvZW5kIHBvc2l0aW9uIG9mIGxheW91dCAoZGVwZW5kcyBvbiBkb2N1bWVudCBkaXJlY3Rpb24sIGxlZnQgdG8gcmlnaHQgb3IgcmlnaHQgdG8gbGVmdClcbiAqIEl0IGNhbiBiZSBmaXhlZCAoc2hvd24gYWJvdmUgdGhlIGNvbnRlbnQpIG9yIGNhbiBwdXNoIHRoZSBsYXlvdXQgd2hlbiBvcGVuZWQuXG4gKlxuICogVGhlcmUgYXJlIHRocmVlIHN0YXRlcyAtIGBleHBhbmRlZGAsIGBjb2xsYXBzZWRgLCBgY29tcGFjdGVkYC5cbiAqIEJ5IGRlZmF1bHQgc2lkZWJhciBjb250ZW50IGlzIGZpeGVkIGFuZCBzYXZlcyBpdHMgcG9zaXRpb24gd2hpbGUgdGhlIHBhZ2UgaXMgYmVpbmcgc2Nyb2xsZWQuXG4gKlxuICogQ29tcGFjdGVkIHNpZGViYXIgZXhhbXBsZTpcbiAqIEBzdGFja2VkLWV4YW1wbGUoQ29tcGFjdGVkIFNpZGViYXIsIHNpZGViYXIvc2lkZWJhci1jb21wYWN0ZWQuY29tcG9uZW50KVxuICpcbiAqIFNpZGViYXIgYWxzbyBzdXBwb3J0cyBhIGByZXNwb25zaXZlYCBiZWhhdmlvciwgbGlzdGVuaW5nIHRvIHdpbmRvdyBzaXplIGNoYW5nZSBhbmQgY2hhbmdpbmcgaXRzIHNpemUgcmVzcGVjdGFibHkuXG4gKlxuICogSW4gYSBwYWlyIHdpdGggaGVhZGVyIGl0IGlzIHBvc3NpYmxlIHRvIHNldHVwIGEgY29uZmlndXJhdGlvbiB3aGVuIGhlYWRlciBpcyBwbGFjZWQgb24gYSBzaWRlIG9mIHRoZSBzaWRlYmFyXG4gKiBhbmQgbm90IG9uIHRvcCBvZiBpdC4gVG8gYWNoaWV2ZSB0aGlzIHNpbXBseSBwdXQgYSBgc3ViaGVhZGVyYCBwcm9wZXJ0eSB0byB0aGUgaGVhZGVyIGxpa2UgdGhpczpcbiAqIGBgYGh0bWxcbiAqIDxuYi1sYXlvdXQtaGVhZGVyIHN1YmhlYWRlcj48L25iLWxheW91dC1oZWFkZXI+XG4gKiBgYGBcbiAqIEBzdGFja2VkLWV4YW1wbGUoU3ViaGVhZGVyLCBsYXlvdXQvbGF5b3V0LXNpZGViYXItc3ViaGVhZGVyLmNvbXBvbmVudClcbiAqIE5vdGUgdGhhdCBpbiBzdWNoIGNvbmZpZ3VyYXRpb24gc2lkZWJhciBzaGFkb3cgaXMgcmVtb3ZlZCBhbmQgaGVhZGVyIGNhbm5vdCBiZSBtYWtlIGBmaXhlZGAuXG4gKlxuICogQGFkZGl0aW9uYWwtZXhhbXBsZShSaWdodCBTaWRlYmFyLCBzaWRlYmFyL3NpZGViYXItcmlnaHQuY29tcG9uZW50KVxuICogQGFkZGl0aW9uYWwtZXhhbXBsZShGaXhlZCBTaWRlYmFyLCBzaWRlYmFyL3NpZGViYXItZml4ZWQuY29tcG9uZW50KVxuICpcbiAqIEBzdHlsZXNcbiAqXG4gKiBzaWRlYmFyLWJhY2tncm91bmQtY29sb3I6XG4gKiBzaWRlYmFyLXRleHQtY29sb3I6XG4gKiBzaWRlYmFyLXRleHQtZm9udC1mYW1pbHk6XG4gKiBzaWRlYmFyLXRleHQtZm9udC1zaXplOlxuICogc2lkZWJhci10ZXh0LWZvbnQtd2VpZ2h0OlxuICogc2lkZWJhci10ZXh0LWxpbmUtaGVpZ2h0OlxuICogc2lkZWJhci1oZWlnaHQ6XG4gKiBzaWRlYmFyLXdpZHRoOlxuICogc2lkZWJhci13aWR0aC1jb21wYWN0OlxuICogc2lkZWJhci1wYWRkaW5nOlxuICogc2lkZWJhci1oZWFkZXItaGVpZ2h0OlxuICogc2lkZWJhci1mb290ZXItaGVpZ2h0OlxuICogc2lkZWJhci1zaGFkb3c6XG4gKiBzaWRlYmFyLW1lbnUtaXRlbS1oaWdobGlnaHQtY29sb3I6XG4gKiBzaWRlYmFyLXNjcm9sbGJhci1iYWNrZ3JvdW5kLWNvbG9yOlxuICogc2lkZWJhci1zY3JvbGxiYXItY29sb3I6XG4gKiBzaWRlYmFyLXNjcm9sbGJhci13aWR0aDpcbiAqL1xuQENvbXBvbmVudCh7XG4gIHNlbGVjdG9yOiAnbmItc2lkZWJhcicsXG4gIHN0eWxlVXJsczogWycuL3NpZGViYXIuY29tcG9uZW50LnNjc3MnXSxcbiAgdGVtcGxhdGU6IGBcbiAgICA8ZGl2IGNsYXNzPVwibWFpbi1jb250YWluZXJcIiBbY2xhc3MubWFpbi1jb250YWluZXItZml4ZWRdPVwiY29udGFpbmVyRml4ZWRWYWx1ZVwiPlxuICAgICAgPG5nLWNvbnRlbnQgc2VsZWN0PVwibmItc2lkZWJhci1oZWFkZXJcIj48L25nLWNvbnRlbnQ+XG4gICAgICA8ZGl2IGNsYXNzPVwic2Nyb2xsYWJsZVwiIChjbGljayk9XCJvbkNsaWNrKCRldmVudClcIj5cbiAgICAgICAgPG5nLWNvbnRlbnQ+PC9uZy1jb250ZW50PlxuICAgICAgPC9kaXY+XG4gICAgICA8bmctY29udGVudCBzZWxlY3Q9XCJuYi1zaWRlYmFyLWZvb3RlclwiPjwvbmctY29udGVudD5cbiAgICA8L2Rpdj5cbiAgYCxcbiAgY2hhbmdlRGV0ZWN0aW9uOiBDaGFuZ2VEZXRlY3Rpb25TdHJhdGVneS5PblB1c2gsXG59KVxuZXhwb3J0IGNsYXNzIE5iU2lkZWJhckNvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCwgT25EZXN0cm95IHtcbiAgcHJvdGVjdGVkIHJlYWRvbmx5IHJlc3BvbnNpdmVWYWx1ZUNoYW5nZSQ6IFN1YmplY3Q8Ym9vbGVhbj4gPSBuZXcgU3ViamVjdDxib29sZWFuPigpO1xuICBwcm90ZWN0ZWQgcmVzcG9uc2l2ZVN0YXRlOiBOYlNpZGViYXJSZXNwb25zaXZlU3RhdGUgPSAncGMnO1xuXG4gIHByb3RlY3RlZCBkZXN0cm95JCA9IG5ldyBTdWJqZWN0PHZvaWQ+KCk7XG5cbiAgY29udGFpbmVyRml4ZWRWYWx1ZTogYm9vbGVhbiA9IHRydWU7XG5cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5maXhlZCcpIGZpeGVkVmFsdWU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5yaWdodCcpIHJpZ2h0VmFsdWU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5sZWZ0JykgbGVmdFZhbHVlOiBib29sZWFuID0gdHJ1ZTtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5zdGFydCcpIHN0YXJ0VmFsdWU6IGJvb2xlYW4gPSBmYWxzZTtcbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5lbmQnKSBlbmRWYWx1ZTogYm9vbGVhbiA9IGZhbHNlO1xuXG4gIEBIb3N0QmluZGluZygnY2xhc3MuZXhwYW5kZWQnKVxuICBnZXQgZXhwYW5kZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGUgPT09ICdleHBhbmRlZCc7XG4gIH1cbiAgQEhvc3RCaW5kaW5nKCdjbGFzcy5jb2xsYXBzZWQnKVxuICBnZXQgY29sbGFwc2VkKCkge1xuICAgIHJldHVybiB0aGlzLnN0YXRlID09PSAnY29sbGFwc2VkJztcbiAgfVxuICBASG9zdEJpbmRpbmcoJ2NsYXNzLmNvbXBhY3RlZCcpXG4gIGdldCBjb21wYWN0ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXMuc3RhdGUgPT09ICdjb21wYWN0ZWQnO1xuICB9XG5cbiAgLyoqXG4gICAqIFBsYWNlcyBzaWRlYmFyIG9uIHRoZSByaWdodCBzaWRlXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKi9cbiAgQElucHV0KClcbiAgc2V0IHJpZ2h0KHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMucmlnaHRWYWx1ZSA9IGNvbnZlcnRUb0Jvb2xQcm9wZXJ0eSh2YWwpO1xuICAgIHRoaXMubGVmdFZhbHVlID0gIXRoaXMucmlnaHRWYWx1ZTtcbiAgICB0aGlzLnN0YXJ0VmFsdWUgPSBmYWxzZTtcbiAgICB0aGlzLmVuZFZhbHVlID0gZmFsc2U7XG4gIH1cbiAgc3RhdGljIG5nQWNjZXB0SW5wdXRUeXBlX3JpZ2h0OiBOYkJvb2xlYW5JbnB1dDtcblxuICAvKipcbiAgICogUGxhY2VzIHNpZGViYXIgb24gdGhlIGxlZnQgc2lkZVxuICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICovXG4gIEBJbnB1dCgpXG4gIHNldCBsZWZ0KHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMubGVmdFZhbHVlID0gY29udmVydFRvQm9vbFByb3BlcnR5KHZhbCk7XG4gICAgdGhpcy5yaWdodFZhbHVlID0gIXRoaXMubGVmdFZhbHVlO1xuICAgIHRoaXMuc3RhcnRWYWx1ZSA9IGZhbHNlO1xuICAgIHRoaXMuZW5kVmFsdWUgPSBmYWxzZTtcbiAgfVxuICBzdGF0aWMgbmdBY2NlcHRJbnB1dFR5cGVfbGVmdDogTmJCb29sZWFuSW5wdXQ7XG5cbiAgLyoqXG4gICAqIFBsYWNlcyBzaWRlYmFyIG9uIHRoZSBzdGFydCBlZGdlIG9mIGxheW91dFxuICAgKiBAdHlwZSB7Ym9vbGVhbn1cbiAgICovXG4gIEBJbnB1dCgpXG4gIHNldCBzdGFydCh2YWw6IGJvb2xlYW4pIHtcbiAgICB0aGlzLnN0YXJ0VmFsdWUgPSBjb252ZXJ0VG9Cb29sUHJvcGVydHkodmFsKTtcbiAgICB0aGlzLmVuZFZhbHVlID0gIXRoaXMuc3RhcnRWYWx1ZTtcbiAgICB0aGlzLmxlZnRWYWx1ZSA9IGZhbHNlO1xuICAgIHRoaXMucmlnaHRWYWx1ZSA9IGZhbHNlO1xuICB9XG4gIHN0YXRpYyBuZ0FjY2VwdElucHV0VHlwZV9zdGFydDogTmJCb29sZWFuSW5wdXQ7XG5cbiAgLyoqXG4gICAqIFBsYWNlcyBzaWRlYmFyIG9uIHRoZSBlbmQgZWRnZSBvZiBsYXlvdXRcbiAgICogQHR5cGUge2Jvb2xlYW59XG4gICAqL1xuICBASW5wdXQoKVxuICBzZXQgZW5kKHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMuZW5kVmFsdWUgPSBjb252ZXJ0VG9Cb29sUHJvcGVydHkodmFsKTtcbiAgICB0aGlzLnN0YXJ0VmFsdWUgPSAhdGhpcy5lbmRWYWx1ZTtcbiAgICB0aGlzLmxlZnRWYWx1ZSA9IGZhbHNlO1xuICAgIHRoaXMucmlnaHRWYWx1ZSA9IGZhbHNlO1xuICB9XG4gIHN0YXRpYyBuZ0FjY2VwdElucHV0VHlwZV9lbmQ6IE5iQm9vbGVhbklucHV0O1xuXG4gIC8qKlxuICAgKiBNYWtlcyBzaWRlYmFyIGZpeGVkIChzaG93biBhYm92ZSB0aGUgbGF5b3V0IGNvbnRlbnQpXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKi9cbiAgQElucHV0KClcbiAgc2V0IGZpeGVkKHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMuZml4ZWRWYWx1ZSA9IGNvbnZlcnRUb0Jvb2xQcm9wZXJ0eSh2YWwpO1xuICB9XG4gIHN0YXRpYyBuZ0FjY2VwdElucHV0VHlwZV9maXhlZDogTmJCb29sZWFuSW5wdXQ7XG5cbiAgLyoqXG4gICAqIE1ha2VzIHNpZGViYXIgY29udGFpbmVyIGZpeGVkXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKi9cbiAgQElucHV0KClcbiAgc2V0IGNvbnRhaW5lckZpeGVkKHZhbDogYm9vbGVhbikge1xuICAgIHRoaXMuY29udGFpbmVyRml4ZWRWYWx1ZSA9IGNvbnZlcnRUb0Jvb2xQcm9wZXJ0eSh2YWwpO1xuICB9XG4gIHN0YXRpYyBuZ0FjY2VwdElucHV0VHlwZV9jb250YWluZXJGaXhlZDogTmJCb29sZWFuSW5wdXQ7XG5cbiAgLyoqXG4gICAqIEluaXRpYWwgc2lkZWJhciBzdGF0ZSwgYGV4cGFuZGVkYHxgY29sbGFwc2VkYHxgY29tcGFjdGVkYFxuICAgKiBAdHlwZSB7c3RyaW5nfVxuICAgKi9cbiAgQElucHV0KClcbiAgZ2V0IHN0YXRlKCk6IE5iU2lkZWJhclN0YXRlIHtcbiAgICByZXR1cm4gdGhpcy5fc3RhdGU7XG4gIH1cbiAgc2V0IHN0YXRlKHZhbHVlOiBOYlNpZGViYXJTdGF0ZSkge1xuICAgIHRoaXMuX3N0YXRlID0gdmFsdWU7XG4gIH1cbiAgcHJvdGVjdGVkIF9zdGF0ZTogTmJTaWRlYmFyU3RhdGUgPSAnZXhwYW5kZWQnO1xuXG4gIC8qKlxuICAgKiBNYWtlcyBzaWRlYmFyIGxpc3RlbiB0byBtZWRpYSBxdWVyeSBldmVudHMgYW5kIGNoYW5nZSBpdHMgYmVoYXZpb3VyXG4gICAqIEB0eXBlIHtib29sZWFufVxuICAgKi9cbiAgQElucHV0KClcbiAgZ2V0IHJlc3BvbnNpdmUoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIHRoaXMuX3Jlc3BvbnNpdmU7XG4gIH1cbiAgc2V0IHJlc3BvbnNpdmUodmFsdWU6IGJvb2xlYW4pIHtcbiAgICBpZiAodGhpcy5yZXNwb25zaXZlICE9PSBjb252ZXJ0VG9Cb29sUHJvcGVydHkodmFsdWUpKSB7XG4gICAgICB0aGlzLl9yZXNwb25zaXZlID0gIXRoaXMucmVzcG9uc2l2ZTtcbiAgICAgIHRoaXMucmVzcG9uc2l2ZVZhbHVlQ2hhbmdlJC5uZXh0KHRoaXMucmVzcG9uc2l2ZSk7XG4gICAgfVxuICB9XG4gIHByb3RlY3RlZCBfcmVzcG9uc2l2ZTogYm9vbGVhbiA9IGZhbHNlO1xuICBzdGF0aWMgbmdBY2NlcHRJbnB1dFR5cGVfcmVzcG9uc2l2ZTogTmJCb29sZWFuSW5wdXQ7XG5cbiAgLyoqXG4gICAqIFRhZ3MgYSBzaWRlYmFyIHdpdGggc29tZSBJRCwgY2FuIGJlIGxhdGVyIHVzZWQgaW4gdGhlIHNpZGViYXIgc2VydmljZVxuICAgKiB0byBkZXRlcm1pbmUgd2hpY2ggc2lkZWJhciB0cmlnZ2VyZWQgdGhlIGFjdGlvbiwgaWYgbXVsdGlwbGUgc2lkZWJhcnMgZXhpc3Qgb24gdGhlIHBhZ2UuXG4gICAqXG4gICAqIEB0eXBlIHtzdHJpbmd9XG4gICAqL1xuICBASW5wdXQoKSB0YWc6IHN0cmluZztcblxuICAvLyBUT0RPOiBnZXQgd2lkdGggYnkgdGhlIGtleSBhbmQgZGVmaW5lIG9ubHkgbWF4IHdpZHRoIGZvciB0aGUgdGFibGV0cyBhbmQgbW9iaWxlc1xuICAvKipcbiAgICogQ29udHJvbHMgb24gd2hpY2ggc2NyZWVuIHNpemVzIHNpZGViYXIgc2hvdWxkIGJlIHN3aXRjaGVkIHRvIGNvbXBhY3RlZCBzdGF0ZS5cbiAgICogV29ya3Mgb25seSB3aGVuIHJlc3BvbnNpdmUgbW9kZSBpcyBvbi5cbiAgICogRGVmYXVsdCB2YWx1ZXMgYXJlIGBbJ3hzJywgJ2lzJywgJ3NtJywgJ21kJywgJ2xnJ11gLlxuICAgKlxuICAgKiBAdHlwZSBzdHJpbmdbXVxuICAgKi9cbiAgQElucHV0KCkgY29tcGFjdGVkQnJlYWtwb2ludHM6IHN0cmluZ1tdID0gWyd4cycsICdpcycsICdzbScsICdtZCcsICdsZyddO1xuXG4gIC8qKlxuICAgKiBDb250cm9scyBvbiB3aGljaCBzY3JlZW4gc2l6ZXMgc2lkZWJhciBzaG91bGQgYmUgc3dpdGNoZWQgdG8gY29sbGFwc2VkIHN0YXRlLlxuICAgKiBXb3JrcyBvbmx5IHdoZW4gcmVzcG9uc2l2ZSBtb2RlIGlzIG9uLlxuICAgKiBEZWZhdWx0IHZhbHVlcyBhcmUgYFsneHMnLCAnaXMnXWAuXG4gICAqXG4gICAqIEB0eXBlIHN0cmluZ1tdXG4gICAqL1xuICBASW5wdXQoKSBjb2xsYXBzZWRCcmVha3BvaW50czogc3RyaW5nW10gPSBbJ3hzJywgJ2lzJ107XG5cbiAgLyoqXG4gICAqIEVtaXRzIHdoZW5ldmVyIHNpZGViYXIgc3RhdGUgY2hhbmdlLlxuICAgKi9cbiAgQE91dHB1dCgpIHJlYWRvbmx5IHN0YXRlQ2hhbmdlID0gbmV3IEV2ZW50RW1pdHRlcjxOYlNpZGViYXJTdGF0ZT4oKTtcblxuICAvKipcbiAgICogRW1pdHMgd2hlbmV2ZXIgc2lkZWJhciByZXNwb25zaXZlIHN0YXRlIGNoYW5nZS5cbiAgICovXG4gIEBPdXRwdXQoKSByZWFkb25seSByZXNwb25zaXZlU3RhdGVDaGFuZ2UgPSBuZXcgRXZlbnRFbWl0dGVyPE5iU2lkZWJhclJlc3BvbnNpdmVTdGF0ZT4oKTtcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwcml2YXRlIHNpZGViYXJTZXJ2aWNlOiBOYlNpZGViYXJTZXJ2aWNlLFxuICAgIHByaXZhdGUgdGhlbWVTZXJ2aWNlOiBOYlRoZW1lU2VydmljZSxcbiAgICBwcml2YXRlIGVsZW1lbnQ6IEVsZW1lbnRSZWYsXG4gICAgcHJpdmF0ZSBjZDogQ2hhbmdlRGV0ZWN0b3JSZWYsXG4gICkge31cblxuICBuZ09uSW5pdCgpIHtcbiAgICB0aGlzLnNpZGViYXJTZXJ2aWNlXG4gICAgICAub25Ub2dnbGUoKVxuICAgICAgLnBpcGUoXG4gICAgICAgIGZpbHRlcigoeyB0YWcgfSkgPT4gIXRoaXMudGFnIHx8IHRoaXMudGFnID09PSB0YWcpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JCksXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCh7IGNvbXBhY3QgfSkgPT4gdGhpcy50b2dnbGUoY29tcGFjdCkpO1xuXG4gICAgdGhpcy5zaWRlYmFyU2VydmljZVxuICAgICAgLm9uRXhwYW5kKClcbiAgICAgIC5waXBlKFxuICAgICAgICBmaWx0ZXIoKHsgdGFnIH0pID0+ICF0aGlzLnRhZyB8fCB0aGlzLnRhZyA9PT0gdGFnKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpLFxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLmV4cGFuZCgpKTtcblxuICAgIHRoaXMuc2lkZWJhclNlcnZpY2VcbiAgICAgIC5vbkNvbGxhcHNlKClcbiAgICAgIC5waXBlKFxuICAgICAgICBmaWx0ZXIoKHsgdGFnIH0pID0+ICF0aGlzLnRhZyB8fCB0aGlzLnRhZyA9PT0gdGFnKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpLFxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLmNvbGxhcHNlKCkpO1xuXG4gICAgdGhpcy5zaWRlYmFyU2VydmljZVxuICAgICAgLm9uQ29tcGFjdCgpXG4gICAgICAucGlwZShcbiAgICAgICAgZmlsdGVyKCh7IHRhZyB9KSA9PiAhdGhpcy50YWcgfHwgdGhpcy50YWcgPT09IHRhZyksXG4gICAgICAgIHRha2VVbnRpbCh0aGlzLmRlc3Ryb3kkKSxcbiAgICAgIClcbiAgICAgIC5zdWJzY3JpYmUoKCkgPT4gdGhpcy5jb21wYWN0KCkpO1xuXG4gICAgZ2V0U2lkZWJhclN0YXRlJFxuICAgICAgLnBpcGUoXG4gICAgICAgIGZpbHRlcigoeyB0YWcgfSkgPT4gIXRoaXMudGFnIHx8IHRoaXMudGFnID09PSB0YWcpLFxuICAgICAgICB0YWtlVW50aWwodGhpcy5kZXN0cm95JCksXG4gICAgICApXG4gICAgICAuc3Vic2NyaWJlKCh7IG9ic2VydmVyIH0pID0+IG9ic2VydmVyLm5leHQodGhpcy5zdGF0ZSkpO1xuXG4gICAgZ2V0U2lkZWJhclJlc3BvbnNpdmVTdGF0ZSRcbiAgICAgIC5waXBlKFxuICAgICAgICBmaWx0ZXIoKHsgdGFnIH0pID0+ICF0aGlzLnRhZyB8fCB0aGlzLnRhZyA9PT0gdGFnKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpLFxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgoeyBvYnNlcnZlciB9KSA9PiBvYnNlcnZlci5uZXh0KHRoaXMucmVzcG9uc2l2ZVN0YXRlKSk7XG5cbiAgICB0aGlzLnJlc3BvbnNpdmVWYWx1ZUNoYW5nZSRcbiAgICAgIC5waXBlKFxuICAgICAgICBmaWx0ZXIoKHJlc3BvbnNpdmU6IGJvb2xlYW4pID0+ICFyZXNwb25zaXZlKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpLFxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgoKSA9PiB0aGlzLmV4cGFuZCgpKTtcblxuICAgIHRoaXMuc3Vic2NyaWJlVG9NZWRpYVF1ZXJ5Q2hhbmdlKCk7XG4gIH1cblxuICBuZ09uRGVzdHJveSgpIHtcbiAgICB0aGlzLmRlc3Ryb3kkLm5leHQoKTtcbiAgICB0aGlzLmRlc3Ryb3kkLmNvbXBsZXRlKCk7XG4gIH1cblxuICAvLyBUT0RPOiB0aGlzIGlzIG1vcmUgb2YgYSB3b3JrYXJvdW5kLCBzaG91bGQgYmUgYSBiZXR0ZXIgd2F5IHRvIG1ha2UgY29tcG9uZW50cyBjb21tdW5pY2F0ZSB0byBlYWNoIG90aGVyXG4gIG9uQ2xpY2soZXZlbnQpOiB2b2lkIHtcbiAgICBjb25zdCBtZW51ID0gdGhpcy5lbGVtZW50Lm5hdGl2ZUVsZW1lbnQucXVlcnlTZWxlY3RvcignbmItbWVudScpO1xuXG4gICAgaWYgKG1lbnUgJiYgbWVudS5jb250YWlucyhldmVudC50YXJnZXQpKSB7XG4gICAgICBjb25zdCBsaW5rID0gdGhpcy5nZXRNZW51TGluayhldmVudC50YXJnZXQpO1xuXG4gICAgICBpZiAobGluayAmJiBsaW5rLm5leHRFbGVtZW50U2libGluZyAmJiBsaW5rLm5leHRFbGVtZW50U2libGluZy5jbGFzc0xpc3QuY29udGFpbnMoJ21lbnUtaXRlbXMnKSkge1xuICAgICAgICB0aGlzLnNpZGViYXJTZXJ2aWNlLmV4cGFuZCh0aGlzLnRhZyk7XG4gICAgICB9XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIENvbGxhcHNlcyB0aGUgc2lkZWJhclxuICAgKi9cbiAgY29sbGFwc2UoKSB7XG4gICAgdGhpcy51cGRhdGVTdGF0ZSgnY29sbGFwc2VkJyk7XG4gIH1cblxuICAvKipcbiAgICogRXhwYW5kcyB0aGUgc2lkZWJhclxuICAgKi9cbiAgZXhwYW5kKCkge1xuICAgIHRoaXMudXBkYXRlU3RhdGUoJ2V4cGFuZGVkJyk7XG4gIH1cblxuICAvKipcbiAgICogQ29tcGFjdHMgdGhlIHNpZGViYXIgKG1pbmltaXplcylcbiAgICovXG4gIGNvbXBhY3QoKSB7XG4gICAgdGhpcy51cGRhdGVTdGF0ZSgnY29tcGFjdGVkJyk7XG4gIH1cblxuICAvKipcbiAgICogVG9nZ2xlcyBzaWRlYmFyIHN0YXRlIChleHBhbmRlZHxjb2xsYXBzZWR8Y29tcGFjdGVkKVxuICAgKiBAcGFyYW0ge2Jvb2xlYW59IGNvbXBhY3QgSWYgdHJ1ZSwgdGhlbiBzaWRlYmFyIHN0YXRlIHdpbGwgYmUgY2hhbmdlZCBiZXR3ZWVuIGV4cGFuZGVkICYgY29tcGFjdGVkLFxuICAgKiBvdGhlcndpc2UgLSBiZXR3ZWVuIGV4cGFuZGVkICYgY29sbGFwc2VkLiBGYWxzZSBieSBkZWZhdWx0LlxuICAgKlxuICAgKiBUb2dnbGUgc2lkZWJhciBzdGF0ZVxuICAgKlxuICAgKiBgYGB0c1xuICAgKiB0aGlzLnNpZGViYXIudG9nZ2xlKHRydWUpO1xuICAgKiBgYGBcbiAgICovXG4gIHRvZ2dsZShjb21wYWN0OiBib29sZWFuID0gZmFsc2UpIHtcbiAgICBpZiAodGhpcy5yZXNwb25zaXZlKSB7XG4gICAgICBpZiAodGhpcy5yZXNwb25zaXZlU3RhdGUgPT09ICdtb2JpbGUnKSB7XG4gICAgICAgIGNvbXBhY3QgPSBmYWxzZTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAodGhpcy5zdGF0ZSA9PT0gJ2NvbXBhY3RlZCcgfHwgdGhpcy5zdGF0ZSA9PT0gJ2NvbGxhcHNlZCcpIHtcbiAgICAgIHRoaXMudXBkYXRlU3RhdGUoJ2V4cGFuZGVkJyk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudXBkYXRlU3RhdGUoY29tcGFjdCA/ICdjb21wYWN0ZWQnIDogJ2NvbGxhcHNlZCcpO1xuICAgIH1cbiAgfVxuXG4gIHByb3RlY3RlZCBzdWJzY3JpYmVUb01lZGlhUXVlcnlDaGFuZ2UoKSB7XG4gICAgY29tYmluZUxhdGVzdChbXG4gICAgICB0aGlzLnJlc3BvbnNpdmVWYWx1ZUNoYW5nZSQucGlwZShzdGFydFdpdGgodGhpcy5yZXNwb25zaXZlKSksXG4gICAgICB0aGlzLnRoZW1lU2VydmljZS5vbk1lZGlhUXVlcnlDaGFuZ2UoKSBhcyBPYnNlcnZhYmxlPFtOYk1lZGlhQnJlYWtwb2ludCwgTmJNZWRpYUJyZWFrcG9pbnRdPixcbiAgICBdKVxuICAgICAgLnBpcGUoXG4gICAgICAgIGZpbHRlcigoW3Jlc3BvbnNpdmVdKSA9PiByZXNwb25zaXZlKSxcbiAgICAgICAgbWFwKChbLCBicmVha3BvaW50c10pID0+IGJyZWFrcG9pbnRzKSxcbiAgICAgICAgdGFrZVVudGlsKHRoaXMuZGVzdHJveSQpLFxuICAgICAgKVxuICAgICAgLnN1YnNjcmliZSgoW3ByZXYsIGN1cnJlbnRdOiBbTmJNZWRpYUJyZWFrcG9pbnQsIE5iTWVkaWFCcmVha3BvaW50XSkgPT4ge1xuICAgICAgICBjb25zdCBpc0NvbGxhcHNlZCA9IHRoaXMuY29sbGFwc2VkQnJlYWtwb2ludHMuaW5jbHVkZXMoY3VycmVudC5uYW1lKTtcbiAgICAgICAgY29uc3QgaXNDb21wYWN0ZWQgPSB0aGlzLmNvbXBhY3RlZEJyZWFrcG9pbnRzLmluY2x1ZGVzKGN1cnJlbnQubmFtZSk7XG5cbiAgICAgICAgbGV0IG5ld1Jlc3BvbnNpdmVTdGF0ZTtcblxuICAgICAgICBpZiAoaXNDb21wYWN0ZWQpIHtcbiAgICAgICAgICB0aGlzLmZpeGVkID0gdGhpcy5jb250YWluZXJGaXhlZFZhbHVlO1xuICAgICAgICAgIHRoaXMuY29tcGFjdCgpO1xuICAgICAgICAgIG5ld1Jlc3BvbnNpdmVTdGF0ZSA9ICd0YWJsZXQnO1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0NvbGxhcHNlZCkge1xuICAgICAgICAgIHRoaXMuZml4ZWQgPSB0cnVlO1xuICAgICAgICAgIHRoaXMuY29sbGFwc2UoKTtcbiAgICAgICAgICBuZXdSZXNwb25zaXZlU3RhdGUgPSAnbW9iaWxlJztcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzQ29sbGFwc2VkICYmICFpc0NvbXBhY3RlZCAmJiAoIXByZXYud2lkdGggfHwgcHJldi53aWR0aCA8IGN1cnJlbnQud2lkdGgpKSB7XG4gICAgICAgICAgdGhpcy5leHBhbmQoKTtcbiAgICAgICAgICB0aGlzLmZpeGVkID0gZmFsc2U7XG4gICAgICAgICAgbmV3UmVzcG9uc2l2ZVN0YXRlID0gJ3BjJztcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChuZXdSZXNwb25zaXZlU3RhdGUgJiYgbmV3UmVzcG9uc2l2ZVN0YXRlICE9PSB0aGlzLnJlc3BvbnNpdmVTdGF0ZSkge1xuICAgICAgICAgIHRoaXMucmVzcG9uc2l2ZVN0YXRlID0gbmV3UmVzcG9uc2l2ZVN0YXRlO1xuICAgICAgICAgIHRoaXMucmVzcG9uc2l2ZVN0YXRlQ2hhbmdlLmVtaXQodGhpcy5yZXNwb25zaXZlU3RhdGUpO1xuICAgICAgICAgIHRoaXMuY2QubWFya0ZvckNoZWNrKCk7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICB9XG5cbiAgcHJvdGVjdGVkIGdldE1lbnVMaW5rKGVsZW1lbnQ6IEhUTUxFbGVtZW50KTogSFRNTEVsZW1lbnQgfCB1bmRlZmluZWQge1xuICAgIGlmICghZWxlbWVudCB8fCBlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ25iLW1lbnUnKSB7XG4gICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cblxuICAgIGlmIChlbGVtZW50LnRhZ05hbWUudG9Mb3dlckNhc2UoKSA9PT0gJ2EnKSB7XG4gICAgICByZXR1cm4gZWxlbWVudDtcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5nZXRNZW51TGluayhlbGVtZW50LnBhcmVudEVsZW1lbnQpO1xuICB9XG5cbiAgcHJvdGVjdGVkIHVwZGF0ZVN0YXRlKHN0YXRlOiBOYlNpZGViYXJTdGF0ZSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnN0YXRlICE9PSBzdGF0ZSkge1xuICAgICAgdGhpcy5zdGF0ZSA9IHN0YXRlO1xuICAgICAgdGhpcy5zdGF0ZUNoYW5nZS5lbWl0KHRoaXMuc3RhdGUpO1xuICAgICAgdGhpcy5jZC5tYXJrRm9yQ2hlY2soKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==